â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ğŸš€ PRODUCTION SERVER - FINAL DEPLOYMENT STEPS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Your campaign #1 is showing:
  âœ“ Status: RUNNING
  âœ“ Total: 89 emails
  âœ“ Sent: 1
  âœ“ Pending: 88
  âœ— STUCK - Not continuing to send

WHY: Cron job is NOT installed on production server!

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
SOLUTION: Install Cron Job (2 Minutes)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

METHOD 1: Manual (Easiest)
---------------------------
1. SSH to server:
   ssh user@payrollsoft.in

2. Edit crontab:
   crontab -e

3. Add this line (copy exactly):
   */2 * * * * /opt/plesk/php/8.1/bin/php /var/www/vhosts/payrollsoft.in/httpdocs/emailvalidation/backend/campaign_cron.php >> /var/www/vhosts/payrollsoft.in/httpdocs/emailvalidation/backend/logs/cron_output.log 2>&1

4. Save and exit (:wq in vim)

5. Verify:
   crontab -l

METHOD 2: Automated Script
----------------------------
1. Upload setup_production.sh to server

2. Run it:
   bash setup_production.sh

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
WHAT HAPPENS AFTER CRON IS INSTALLED
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ“ Every 2 minutes, cron checks for running campaigns
âœ“ Finds campaign #1 with status = 'running'
âœ“ Launches email_blast_parallel.php
âœ“ Sends emails continuously until all 88 are sent
âœ“ Updates database: sent_emails increases, pending decreases
âœ“ When done, sets status = 'completed'

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
TEST IMMEDIATELY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

After installing cron, test it manually:

/opt/plesk/php/8.1/bin/php /var/www/vhosts/payrollsoft.in/httpdocs/emailvalidation/backend/campaign_cron.php

You should see:
  "Database config loaded for: PRODUCTION - DB: email_id"
  "Found running campaign #1"
  "Launching email orchestrator..."

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
MONITOR PROGRESS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Watch cron output:
  tail -f /var/www/vhosts/payrollsoft.in/httpdocs/emailvalidation/backend/logs/cron_output.log

Watch campaign progress:
  tail -f /var/www/vhosts/payrollsoft.in/httpdocs/emailvalidation/backend/logs/orchestrator_*.log

Check database (refresh every 5 seconds):
  watch -n 5 'mysql -u email_id -p email_id -e "SELECT sent_emails, pending_emails FROM campaign_status WHERE campaign_id = 1;"'

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
VERIFICATION CHECKLIST
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Before starting:
  âœ“ Campaign has user_id = 1 (FIXED)
  âœ“ Campaign has csv_list_id = 2 (FIXED)
  âœ“ CSV list has 89 valid emails (CONFIRMED)
  âœ“ User has active SMTP accounts (MUST VERIFY)
  âœ— Cron job installed (TODO - DO THIS NOW!)

To verify SMTP accounts exist:
  mysql -u email_id -p email_id -e "SELECT COUNT(*) FROM smtp_accounts WHERE user_id = 1 AND is_active = 1;"

Should return: at least 1

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
TROUBLESHOOTING
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Problem: Cron runs but no emails send

Check 1: User has SMTP accounts
  mysql -u email_id -p email_id -e "
    SELECT sa.id, sa.email, sa.is_active, ss.name 
    FROM smtp_accounts sa 
    JOIN smtp_servers ss ON sa.smtp_server_id = ss.id 
    WHERE sa.user_id = 1;"

  Result: Should show at least 1 active account

Check 2: Check logs for errors
  tail -100 /var/www/vhosts/payrollsoft.in/httpdocs/emailvalidation/backend/logs/cron_output.log

Check 3: Process running?
  ps aux | grep email_blast

Check 4: Campaign still running?
  mysql -u email_id -p email_id -e "SELECT status FROM campaign_status WHERE campaign_id = 1;"

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
EXPECTED TIMELINE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

00:00 - Install cron job
00:02 - Cron detects running campaign #1
00:03 - Orchestrator launches, workers start
00:04 - First batch of emails sent (10-20 emails/minute)
00:10 - Sent: 50-100 emails
00:15 - All 88 emails sent
00:15 - Status changes to 'completed'

With 89 emails and typical sending speed, expect completion in 10-15 minutes.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
FINAL COMMAND TO INSTALL CRON
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Copy this command and run on production server:

(crontab -l 2>/dev/null; echo "*/2 * * * * /opt/plesk/php/8.1/bin/php /var/www/vhosts/payrollsoft.in/httpdocs/emailvalidation/backend/campaign_cron.php >> /var/www/vhosts/payrollsoft.in/httpdocs/emailvalidation/backend/logs/cron_output.log 2>&1") | crontab -

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
