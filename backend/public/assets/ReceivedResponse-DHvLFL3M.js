import{a as e,j as s}from"./react-core-DPHBRSZI.js";import{A as t}from"./index-yWi9ERo7.js";import"./react-dom-CzVnfz0w.js";import"./vendor-CNpwfz3n.js";import"./react-router-CQqd29q0.js";const r=t.APP,a=({servers:e,selectedServer:t,onSelectServer:r})=>s.jsxs("div",{className:"w-1/5 bg-white border-r border-gray-200 flex flex-col",children:[s.jsx("div",{className:"p-4 border-b border-gray-200",children:s.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Mail Accounts"})}),s.jsx("div",{className:"flex-1 overflow-y-auto",children:e.map(e=>s.jsxs("button",{onClick:()=>r(e.id),className:"w-full text-left px-4 py-3 flex items-center transition-colors "+(t===e.id?"bg-blue-50 text-blue-600 border-r-2 border-blue-500":"hover:bg-gray-100 text-gray-700"),children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center mr-3",children:s.jsx("span",{className:"text-sm font-medium text-blue-600",children:e.name?e.name.charAt(0).toUpperCase():e.email.charAt(0).toUpperCase()})}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-medium truncate",children:e.name||e.email}),s.jsx("div",{className:"text-xs text-gray-500 truncate",children:e.email})]})]},e.id))})]}),l=({emails:e,loading:t,error:r,selectedEmail:a,onSelectEmail:l})=>s.jsxs("div",{className:"w-1/5 border-r border-gray-200 bg-white overflow-y-auto",children:[t&&s.jsxs("div",{className:"flex flex-col items-center justify-center h-64",children:[s.jsx("div",{className:"w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"}),s.jsx("p",{className:"mt-3 text-sm text-gray-500",children:"Loading emails..."})]}),r&&s.jsxs("div",{className:"p-4 bg-red-50 text-red-600 text-sm rounded m-4",children:[s.jsx("svg",{className:"w-4 h-4 inline mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0114 0z"})}),r]}),!t&&!r&&0===e.length&&s.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-gray-400",children:[s.jsx("svg",{className:"w-12 h-12 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),s.jsx("p",{children:"No emails found"})]}),s.jsx("ul",{children:e.map(e=>s.jsxs("li",{onClick:()=>l(e),className:"border-b border-gray-100 px-4 py-3 cursor-pointer transition-colors "+(a?.uid===e.uid?"bg-blue-50":"hover:bg-gray-50"),children:[s.jsxs("div",{className:"flex justify-between items-start mb-1",children:[s.jsx("span",{className:"font-medium text-sm text-gray-900 truncate",children:e.from_name||e.from_email}),s.jsx("span",{className:"text-xs text-gray-500 whitespace-nowrap ml-2",children:new Date(e.date_received).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),s.jsx("div",{className:"text-sm font-semibold text-gray-800 truncate mb-1",children:e.subject||"(No Subject)"}),s.jsx("div",{className:"text-xs text-gray-500 line-clamp-2",children:e.body})]},e.uid||e.id))})]}),i=({email:t,onReply:r,replyStatus:a})=>{const[l,i]=e.useState("");return t?s.jsxs("div",{className:"w-3/5 bg-white overflow-y-auto flex flex-col",children:[s.jsxs("div",{className:"border-b border-gray-200 px-6 py-4",children:[s.jsx("h1",{className:"text-xl font-bold text-gray-900 mb-2",children:t.subject}),s.jsxs("div",{className:"flex items-start",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center mr-3",children:s.jsx("span",{className:"text-sm font-medium text-blue-600",children:t.from_name?t.from_name.charAt(0).toUpperCase():t.from_email.charAt(0).toUpperCase()})}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.from_name||t.from_email}),s.jsxs("div",{className:"text-xs text-gray-500",children:["to me",s.jsx("span",{className:"mx-2",children:"â€¢"}),new Date(t.date_received).toLocaleString()]})]})]})]}),s.jsx("div",{className:"flex-1 px-6 py-4",children:s.jsx("div",{className:"prose max-w-none text-gray-800 whitespace-pre-wrap",children:t.body})}),s.jsxs("div",{className:"border-t border-gray-200 px-6 py-4 bg-gray-50",children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Reply"}),s.jsx("textarea",{rows:6,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Write your reply here...",value:l,onChange:e=>i(e.target.value)})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("button",{onClick:()=>{r(l),i("")},disabled:!l,className:"px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:"Send"}),a&&s.jsx("span",{className:"text-sm "+(a.includes("Failed")?"text-red-600":"text-green-600"),children:a})]}),s.jsx("button",{onClick:()=>i(""),className:"text-sm text-gray-500 hover:text-gray-700",children:"Clear"})]})]})]}):s.jsx("div",{className:"w-3/5 flex items-center justify-center bg-gray-50",children:s.jsxs("div",{className:"text-center",children:[s.jsx("svg",{className:"w-16 h-16 mx-auto text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),s.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No email selected"}),s.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Select an email from the list to view its contents"})]})})},n=()=>{const[t,n]=e.useState([]),[c,o]=e.useState(null),[d,m]=e.useState([]),[x,h]=e.useState(null),[u,j]=e.useState(!1),[f,p]=e.useState(""),[b,g]=e.useState("");return e.useEffect(()=>{fetch(`${r}/servers.php`).then(e=>e.json()).then(e=>{n(e.servers||[]),e.servers&&e.servers.length>0&&o(e.servers[0].id)}).catch(()=>p("Failed to load servers"))},[]),e.useEffect(()=>{c&&(j(!0),p(""),h(null),m([]),fetch(`${r}/received_response.php?account_id=${c}`).then(e=>e.json()).then(e=>{e.success?m(e.emails||[]):(p(e.message||"Failed to fetch emails"),m([])),j(!1)}).catch(()=>{p("Failed to fetch emails"),j(!1)}))},[c]),s.jsxs("div",{className:"flex h-screen bg-gray-50 font-sans pt-16",children:[s.jsx(a,{servers:t,selectedServer:c,onSelectServer:o}),s.jsx(l,{emails:d,loading:u,error:f,selectedEmail:x,onSelectEmail:h}),s.jsx(i,{email:x,onReply:e=>{const s={account_id:c,to:x.from_email,subject:"Re: "+x.subject,body:e};g("Sending..."),fetch(`${r}/reply.php`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}).then(e=>e.json()).then(e=>{g(e.success?"Reply sent!":"Failed to send reply")}).catch(()=>g("Failed to send reply"))},replyStatus:b})]})};export{n as default};
