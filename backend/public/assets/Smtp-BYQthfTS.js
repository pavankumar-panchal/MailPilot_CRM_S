import{a as e,j as s,R as t}from"./react-core-DPHBRSZI.js";import{T as a}from"./SkeletonLoader--gW7sJuH.js";import{a as i,A as r}from"./index-yWi9ERo7.js";import"./react-dom-CzVnfz0w.js";import"./vendor-CNpwfz3n.js";import"./react-router-CQqd29q0.js";const l=r.API_MASTER_SMTPS,n={name:"",host:"",port:465,encryption:"ssl",is_active:!0,received_email:"",accounts:[{email:"",password:"",daily_limit:500,hourly_limit:50,is_active:!0}]},o=({status:e,onClose:t})=>e&&s.jsxs("div",{className:`\n        fixed top-6 left-1/2 transform -translate-x-1/2 z-[9999]\n        px-6 py-3 rounded-xl shadow text-base font-semibold\n        flex items-center gap-3\n        transition-all duration-300\n        backdrop-blur-md\n        ${"error"===e.type?"bg-red-200/60 border border-red-400 text-red-800":"bg-green-200/60 border border-green-400 text-green-800"}\n      `,style:{minWidth:250,maxWidth:400,boxShadow:"0 8px 32px 0 rgba(0, 0, 0, 0.23)",background:"error"===e.type?"rgba(255, 0, 0, 0.29)":"rgba(0, 200, 83, 0.29)",borderRadius:"16px",backdropFilter:"blur(8px)",WebkitBackdropFilter:"blur(8px)"},role:"alert",children:[s.jsx("i",{className:"fas text-lg "+("error"===e.type?"fa-exclamation-circle text-red-500":"fa-check-circle text-green-500")}),s.jsx("span",{className:"flex-1",children:e.message}),s.jsx("button",{onClick:t,className:"ml-2 text-gray-500 hover:text-gray-700 focus:outline-none","aria-label":"Close",children:s.jsx("i",{className:"fas fa-times"})})]}),d=()=>{const[r,d]=e.useState([]),[c,m]=e.useState(!0),[x,u]=e.useState(!1),[g,f]=e.useState(!1),[p,h]=e.useState(n),[b,y]=e.useState(null),[j,v]=e.useState(null),[N,w]=e.useState(null),[k,_]=e.useState({email:"",password:"",daily_limit:500,hourly_limit:50,is_active:!0}),[C,S]=e.useState(!1),[A,E]=e.useState(null),[T,P]=e.useState({email:"",from_name:"",password:"",daily_limit:500,hourly_limit:50,is_active:!0}),q=async()=>{m(!0);try{const e=await i(l);if(!e.ok){const s=await e.json().catch(()=>({}));throw new Error(s.error||`HTTP error! status: ${e.status}`)}const s=await e.json();s.success&&Array.isArray(s.data)||Array.isArray(s.data)?d(s.data):Array.isArray(s)?d(s):d([]),"error"===j?.type&&v(null)}catch(e){d([]),v({type:"error",message:e.message||"Failed to load data. Please try again."})}m(!1)};e.useEffect(()=>{q()},[]);const F=e=>{const{name:s,value:t,type:a,checked:i}=e.target;h(e=>({...e,[s]:"checkbox"===a?i:t}))},$=e=>{const{name:s,value:t,type:a,checked:i}=e.target;_(e=>({...e,[s]:"checkbox"===a?i:t}))},L=e=>{const{name:s,value:t,type:a,checked:i}=e.target;P(e=>({...e,[s]:"checkbox"===a?i:t}))};e.useEffect(()=>{if(j){const e=setTimeout(()=>v(null),3e3);return()=>clearTimeout(e)}},[j]);const D=(e,s,t)=>{h(a=>{const i=[...a.accounts];return i[e]={...i[e],[s]:t},{...a,accounts:i}})},M=e=>{h(s=>({...s,accounts:s.accounts.filter((s,t)=>t!==e)}))},H=(e=[])=>{if(!e.length)return"â€”";const t=e.map(e=>Number(e.hourly_limit)||0).reduce((e,s)=>e+s,0),a=e.map(e=>Number(e.daily_limit)||0).reduce((e,s)=>e+s,0);return s.jsxs("span",{children:[s.jsx("span",{className:"font-medium text-indigo-700",children:t}),s.jsx("span",{className:"text-xs text-gray-400",children:"/hr"})," | ",s.jsx("span",{className:"font-medium text-indigo-700",children:a}),s.jsx("span",{className:"text-xs text-gray-400",children:"/day"})]})};return s.jsxs("main",{className:"max-w-7xl mx-auto px-4 mt-14 sm:px-6 py-6",children:[s.jsx(o,{status:j,onClose:()=>v(null)}),s.jsxs("div",{className:"flex justify-between items-center mb-6",children:[s.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[s.jsx("i",{className:"fas fa-server mr-3 text-indigo-600"}),"SMTP Records"]}),s.jsxs("button",{onClick:()=>{h(n),u(!0)},className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[s.jsx("i",{className:"fas fa-plus mr-2"})," Add SMTP Server"]})]}),s.jsx("div",{className:"card overflow-hidden bg-white/80 backdrop-blur-md rounded-xl shadow-lg",children:s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50/80",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-600 uppercase tracking-wider",children:"Server"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-600 uppercase tracking-wider",children:"Accounts"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-600 uppercase tracking-wider",children:"Status"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-600 uppercase tracking-wider",children:"Total Limits"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-600 uppercase tracking-wider",children:"Actions"})]})}),s.jsx("tbody",{className:"bg-white/60 divide-y divide-gray-200",children:c?s.jsx(a,{rows:5,columns:5}):0===r.length?s.jsx("tr",{children:s.jsx("td",{colSpan:5,className:"px-6 py-8 text-center text-sm text-gray-500",children:"No SMTP servers found. Add one to get started."})}):r.map((e,a)=>s.jsxs(t.Fragment,{children:[s.jsxs("tr",{className:"hover:bg-indigo-50/30 transition",children:[s.jsx("td",{className:"px-6 py-4",children:s.jsxs("div",{className:"flex items-center",children:[s.jsxs("div",{className:"text-xs text-gray-400 mr-3",children:["#",a+1]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-base font-semibold text-gray-900",children:e.name}),s.jsxs("div",{className:"text-xs text-gray-500",children:[e.host,":",e.port," (",e.encryption?.toUpperCase()||"None",")"]}),e.received_email&&s.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Reply-To: ",s.jsx("span",{className:"font-medium text-gray-700",children:e.received_email})]})]})]})}),s.jsxs("td",{className:"px-6 py-4",children:[s.jsxs("div",{className:"text-sm text-gray-900",children:[e.accounts?.length||0," account(s)"]}),s.jsx("div",{className:"text-xs text-gray-500 truncate max-w-xs",children:e.accounts?.map(e=>e.email).join(", ")||"No accounts"})]}),s.jsx("td",{className:"px-6 py-4",children:s.jsx("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full "+(e.is_active?"bg-green-100 text-green-700":"bg-red-100 text-red-700"),children:e.is_active?`Active (${e.accounts?.filter(e=>e.is_active).length||0})`:"Inactive"})}),s.jsx("td",{className:"px-6 py-4 text-base text-gray-700",children:H(e.accounts)}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("button",{onClick:()=>{return s=e.id,void w(N===s?null:s);var s},className:"text-indigo-600 hover:text-indigo-900",title:"View accounts",children:s.jsx("i",{className:"fas "+(N===e.id?"fa-eye-slash":"fa-eye")})}),s.jsx("button",{onClick:()=>(e=>{y(e.id);const s=(e.accounts||[]).map(e=>({id:e.id,email:e.email,password:"",daily_limit:e.daily_limit,hourly_limit:e.hourly_limit,is_active:!!e.is_active}));h({...e,is_active:!!e.is_active,accounts:s}),f(!0)})(e),className:"text-indigo-600 hover:text-indigo-900",title:"Edit server",children:s.jsx("i",{className:"fas fa-edit"})}),s.jsx("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this SMTP server?"))try{const s=await i(`${l}&id=${e}`,{method:"DELETE"}),t=await s.json();t.success?(v({type:"success",message:"SMTP server deleted successfully!"}),q()):v({type:"error",message:t.message||"Failed to delete server."})}catch{v({type:"error",message:"Failed to delete server."})}})(e.id),className:"text-red-600 hover:text-red-900",title:"Delete server",children:s.jsx("i",{className:"fas fa-trash"})})]})})]}),N===e.id&&s.jsx("tr",{className:"bg-gray-50",children:s.jsxs("td",{colSpan:5,className:"px-6 py-6",children:[s.jsxs("div",{className:"mb-6",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[s.jsx("div",{className:"bg-indigo-100 p-2 rounded-lg",children:s.jsx("i",{className:"fas fa-users text-indigo-600"})}),s.jsx("h4",{className:"text-lg font-semibold text-gray-800",children:"Email Accounts"})]}),s.jsx("div",{className:"space-y-3",children:e.accounts?.length>0?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:e.accounts.map(t=>s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm hover:shadow-md transition-shadow p-3",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[s.jsx("div",{className:"bg-indigo-50 p-1.5 rounded-md",children:s.jsx("i",{className:"fas fa-envelope text-indigo-600 text-xs"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("div",{className:"font-medium text-gray-800 text-xs truncate",children:t.email}),t.is_active?s.jsxs("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded-full bg-green-100 text-green-700 text-xs font-medium",children:[s.jsx("i",{className:"fas fa-check-circle mr-1"})," Active"]}):s.jsxs("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded-full bg-red-100 text-red-700 text-xs font-medium",children:[s.jsx("i",{className:"fas fa-times-circle mr-1"})," Inactive"]})]})]}),s.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-gray-100",children:[s.jsxs("div",{className:"flex items-center space-x-2 text-xs text-gray-600",children:[s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx("i",{className:"fas fa-clock text-orange-500 text-xs"}),s.jsx("span",{className:"font-medium",children:t.hourly_limit})]}),s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx("i",{className:"fas fa-calendar-day text-blue-500 text-xs"}),s.jsx("span",{className:"font-medium",children:t.daily_limit})]})]}),s.jsxs("div",{className:"flex gap-1",children:[s.jsx("button",{onClick:()=>((e,s)=>{E({serverId:e,accountId:s.id}),P({email:s.email,from_name:s.from_name||"",password:"",daily_limit:s.daily_limit,hourly_limit:s.hourly_limit,is_active:s.is_active}),S(!0)})(e.id,t),className:"inline-flex items-center px-2 py-1 text-xs font-medium text-indigo-600 hover:bg-indigo-50 rounded transition-colors",title:"Edit account",children:s.jsx("i",{className:"fas fa-edit"})}),s.jsx("button",{onClick:()=>(async(e,s)=>{if(window.confirm("Are you sure you want to delete this email account?"))try{const t=await i(`${l}/${e}/accounts/${s}`,{method:"DELETE"}),a=await t.json();a.success?(v({type:"success",message:"Email account deleted successfully!"}),q()):v({type:"error",message:a.message||"Failed to delete email account."})}catch{v({type:"error",message:"Failed to delete email account."})}})(e.id,t.id),className:"inline-flex items-center px-2 py-1 text-xs font-medium text-red-600 hover:bg-red-50 rounded transition-colors",title:"Delete account",children:s.jsx("i",{className:"fas fa-trash-alt"})})]})]})]},t.id))}):s.jsx("div",{className:"text-sm text-gray-500",children:"No accounts configured"})})]}),s.jsxs("div",{className:"border-t border-gray-200 pt-5 mt-5",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[s.jsx("div",{className:"bg-green-100 p-2 rounded-lg",children:s.jsx("i",{className:"fas fa-plus text-green-600"})}),s.jsx("h4",{className:"text-lg font-semibold text-gray-800",children:"Add New Account"})]}),s.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),s.jsx("input",{type:"email",name:"email",value:k.email,onChange:$,className:"block w-full px-4 py-2.5 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-sm",placeholder:"user@example.com"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),s.jsx("input",{type:"password",name:"password",value:k.password,onChange:$,className:"block w-full px-4 py-2.5 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-sm",placeholder:"Password"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Hourly Limit"}),s.jsx("input",{type:"number",name:"hourly_limit",value:k.hourly_limit,onChange:$,className:"block w-full px-4 py-2.5 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-sm"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Daily Limit"}),s.jsx("input",{type:"number",name:"daily_limit",value:k.daily_limit,onChange:$,className:"block w-full px-4 py-2.5 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-sm"})]}),s.jsx("div",{className:"flex items-end",children:s.jsxs("button",{onClick:()=>(async e=>{if(k.email&&k.password)try{const s=await i(`${l}/${e}/accounts`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(k)}),t=await s.json();t.success?(v({type:"success",message:"Email account added successfully!"}),_({email:"",password:"",daily_limit:500,hourly_limit:50,is_active:!0}),q()):v({type:"error",message:t.message||"Failed to add email account."})}catch{v({type:"error",message:"Failed to add email account."})}else v({type:"error",message:"Email and password are required."})})(e.id),disabled:!k.email||!k.password,className:`w-full inline-flex items-center justify-center px-4 py-2.5 border border-transparent text-sm font-medium rounded-md text-white transition-colors ${k.email&&k.password?"bg-indigo-600 hover:bg-indigo-700":"bg-gray-300 cursor-not-allowed"} focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500`,children:[s.jsx("i",{className:"fas fa-plus mr-2"})," Add"]})})]})})]})]})})]},e.id))})]})})}),x&&s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/30 backdrop-blur-md",children:s.jsxs("div",{className:"relative w-full max-w-2xl mx-auto bg-white rounded-lg shadow-lg flex flex-col",style:{maxHeight:"90vh"},children:[s.jsxs("div",{className:"sticky top-0 z-10 bg-white border-b flex justify-between items-center px-5 py-3 rounded-t-lg",children:[s.jsxs("h3",{className:"text-lg font-medium text-gray-900 flex items-center",children:[s.jsx("i",{className:"fas fa-plus-circle mr-2 text-indigo-600"}),"Add New SMTP Server"]}),s.jsx("button",{onClick:()=>u(!1),className:"text-gray-400 hover:text-gray-500",children:s.jsx("i",{className:"fas fa-times"})})]}),s.jsxs("form",{className:"overflow-y-auto px-5 py-4",style:{maxHeight:"75vh"},onSubmit:async e=>{e.preventDefault();const s=p.accounts.filter(e=>e.email&&e.password);if(0!==s.length)try{const e=await i(l,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...p,accounts:s})}),t=await e.json();t.success?(v({type:"success",message:"SMTP server added successfully!"}),u(!1),h(n),q()):v({type:"error",message:t.message||"Failed to add server."})}catch{v({type:"error",message:"Failed to add server."})}else v({type:"error",message:"At least one valid account is required."})},children:[s.jsxs("div",{className:"mb-6",children:[s.jsxs("h4",{className:"text-md font-semibold text-indigo-700 mb-3 flex items-center",children:[s.jsx("i",{className:"fas fa-server mr-2"})," Server Details"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),s.jsx("input",{type:"text",name:"name",required:!0,className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm",placeholder:"SMTP1",value:p.name,onChange:F})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Host"}),s.jsx("input",{type:"text",name:"host",required:!0,className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm",placeholder:"smtp.example.com",value:p.host,onChange:F})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Port"}),s.jsx("input",{type:"number",name:"port",required:!0,className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm",placeholder:"465",value:p.port,onChange:F})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Encryption"}),s.jsxs("select",{name:"encryption",required:!0,className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm",value:p.encryption,onChange:F,children:[s.jsx("option",{value:"ssl",children:"SSL"}),s.jsx("option",{value:"tls",children:"TLS"}),s.jsx("option",{value:"",children:"None"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Received Email"}),s.jsx("input",{type:"email",name:"received_email",required:!0,className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm",placeholder:"inbox@example.com",value:p.received_email,onChange:F})]}),s.jsxs("div",{className:"flex items-center mt-2",children:[s.jsx("input",{type:"checkbox",name:"is_active",id:"add_is_active",checked:p.is_active,onChange:F,className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),s.jsx("label",{htmlFor:"add_is_active",className:"ml-2 block text-sm text-gray-700",children:"Active"})]})]})]}),s.jsxs("div",{children:[s.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-4 flex items-center",children:[s.jsx("i",{className:"fas fa-users text-indigo-600 mr-2"}),"Email Accounts"]}),p.accounts.map((e,t)=>s.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 mb-3 bg-gray-50 relative",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),s.jsx("input",{type:"email",name:"email",required:!0,className:"block w-full px-4 py-2.5 border border-gray-300 rounded-md bg-white focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"user@example.com",value:e.email,onChange:e=>D(t,"email",e.target.value)})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),s.jsx("input",{type:"password",name:"password",required:!0,className:"block w-full px-4 py-2.5 border border-gray-300 rounded-md bg-white focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",value:e.password,onChange:e=>D(t,"password",e.target.value)})]}),s.jsx("div",{className:"flex items-end",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",checked:e.is_active,onChange:e=>D(t,"is_active",e.target.checked),className:"h-4 w-4 text-indigo-600 border-gray-300 rounded"}),s.jsx("label",{className:"ml-2 block text-sm text-gray-700",children:"Active"})]})})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Hourly Limit"}),s.jsx("input",{type:"number",name:"hourly_limit",required:!0,className:"block w-full px-4 py-2.5 border border-gray-300 rounded-md bg-white focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",value:e.hourly_limit,onChange:e=>D(t,"hourly_limit",e.target.value)})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Daily Limit"}),s.jsx("input",{type:"number",name:"daily_limit",required:!0,className:"block w-full px-4 py-2.5 border border-gray-300 rounded-md bg-white focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",value:e.daily_limit,onChange:e=>D(t,"daily_limit",e.target.value)})]})]}),p.accounts.length>1&&s.jsx("button",{type:"button",className:"absolute top-3 right-3 text-red-500 hover:text-red-700",onClick:()=>M(t),title:"Remove this account",children:s.jsx("i",{className:"fas fa-times-circle text-lg"})})]},t)),s.jsxs("button",{type:"button",className:"mt-2 text-indigo-600 hover:text-indigo-700 text-sm font-medium",onClick:()=>{h(e=>({...e,accounts:[...e.accounts,{email:"",password:"",daily_limit:500,hourly_limit:50,is_active:!0}]}))},children:[s.jsx("i",{className:"fas fa-plus mr-2"}),"Add Another Account"]})]}),s.jsxs("div",{className:"flex justify-end pt-6 space-x-3",children:[s.jsx("button",{type:"button",onClick:()=>u(!1),className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Cancel"}),s.jsxs("button",{type:"submit",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[s.jsx("i",{className:"fas fa-save mr-2"})," Save Server"]})]})]})]})}),g&&s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:s.jsxs("div",{className:"relative w-full max-w-2xl mx-auto bg-white rounded-lg shadow-xl flex flex-col",style:{maxHeight:"90vh"},children:[s.jsxs("div",{className:"px-6 py-4 bg-gray-50 border-b border-gray-200 rounded-t-lg flex justify-between items-center",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"bg-gray-100 p-2 rounded-lg",children:s.jsx("i",{className:"fas fa-server text-blue-600 text-lg"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Edit SMTP Server"}),s.jsx("p",{className:"text-gray-500 text-sm",children:"Update server configuration and accounts"})]})]}),s.jsx("button",{onClick:()=>f(!1),className:"text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-md p-2 transition-colors",children:s.jsx("i",{className:"fas fa-times"})})]}),s.jsxs("form",{className:"overflow-y-auto px-6 py-6",style:{maxHeight:"calc(90vh - 140px)"},onSubmit:async e=>{if(e.preventDefault(),b)try{const e={server:{name:p.name,host:p.host,port:p.port,encryption:p.encryption,is_active:p.is_active,received_email:p.received_email},accounts:p.accounts},s=await i(`${l}&id=${b}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),t=await s.json();t.success?(v({type:"success",message:"SMTP server updated successfully!"}),f(!1),h(n),y(null),q()):v({type:"error",message:t.message||"Failed to update server."})}catch(s){v({type:"error",message:`Failed to update server: ${s.message}`})}else v({type:"error",message:"No server ID for update"})},children:[s.jsx("input",{type:"hidden",name:"id",value:b}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-4 flex items-center",children:[s.jsx("i",{className:"fas fa-cog text-indigo-600 mr-2"}),"Server Configuration"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Name"}),s.jsx("input",{type:"text",name:"name",required:!0,className:"block w-full px-4 py-2.5 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",value:p.name,onChange:F})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Host"}),s.jsx("input",{type:"text",name:"host",required:!0,className:"block w-full px-4 py-2.5 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",value:p.host,onChange:F})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Port"}),s.jsx("input",{type:"number",name:"port",required:!0,className:"block w-full px-4 py-2.5 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",value:p.port,onChange:F})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Encryption"}),s.jsxs("select",{name:"encryption",required:!0,className:"block w-full px-4 py-2.5 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",value:p.encryption,onChange:F,children:[s.jsx("option",{value:"ssl",children:"SSL"}),s.jsx("option",{value:"tls",children:"TLS"}),s.jsx("option",{value:"",children:"None"})]})]}),s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Received Email"}),s.jsx("input",{type:"email",name:"received_email",required:!0,className:"block w-full px-4 py-2.5 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"inbox@example.com",value:p.received_email,onChange:F})]})]})]}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-4 flex items-center",children:[s.jsx("i",{className:"fas fa-envelope text-indigo-600 mr-2"}),"Email Accounts"]}),p.accounts&&p.accounts.map((e,t)=>s.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 mb-3 bg-gray-50",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),s.jsx("input",{type:"email",name:"email",required:!0,className:"block w-full px-4 py-2.5 border border-gray-300 rounded-md bg-white focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",value:e.email,onChange:e=>D(t,"email",e.target.value)})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Password",s.jsx("span",{className:"ml-2 text-xs text-gray-500",children:"(leave blank to keep)"})]}),s.jsx("input",{type:"password",name:"password",className:"block w-full px-4 py-2.5 border border-gray-300 rounded-md bg-white focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"Leave blank to keep current",value:e.password||"",onChange:e=>D(t,"password",e.target.value)})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Hourly Limit"}),s.jsx("input",{type:"number",name:"hourly_limit",required:!0,className:"block w-full px-4 py-2.5 border border-gray-300 rounded-md bg-white focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",value:e.hourly_limit,onChange:e=>D(t,"hourly_limit",e.target.value)})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Daily Limit"}),s.jsx("input",{type:"number",name:"daily_limit",required:!0,className:"block w-full px-4 py-2.5 border border-gray-300 rounded-md bg-white focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",value:e.daily_limit,onChange:e=>D(t,"daily_limit",e.target.value)})]})]}),s.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-gray-200",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",checked:e.is_active,onChange:e=>D(t,"is_active",e.target.checked),className:"h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"}),s.jsx("label",{className:"ml-2 text-sm font-medium text-gray-700",children:"Active"})]}),s.jsxs("button",{type:"button",className:"inline-flex items-center text-sm text-red-600 hover:text-red-700 font-medium",onClick:()=>M(t),children:[s.jsx("i",{className:"fas fa-trash-alt mr-1"}),"Remove Account"]})]})]},e.id||t))]}),s.jsx("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200 mb-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("i",{className:`fas fa-${p.is_active?"check-circle":"times-circle"} text-lg ${p.is_active?"text-green-600":"text-gray-400"}`}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"edit_is_active",className:"text-sm font-medium text-gray-700 cursor-pointer",children:"Server Status"}),s.jsx("p",{className:"text-xs text-gray-500",children:p.is_active?"Server is active and can send emails":"Server is disabled"})]})]}),s.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[s.jsx("input",{type:"checkbox",name:"is_active",id:"edit_is_active",checked:p.is_active,onChange:F,className:"sr-only peer"}),s.jsx("div",{className:"w-11 h-6 bg-gray-300 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-indigo-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-indigo-600"})]})]})})]}),s.jsxs("div",{className:"flex justify-end px-6 py-4 space-x-3 bg-gray-50 rounded-b-lg border-t border-gray-200",children:[s.jsxs("button",{type:"button",onClick:()=>f(!1),className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[s.jsx("i",{className:"fas fa-times mr-2"}),"Cancel"]}),s.jsxs("button",{type:"submit",onClick:e=>{e.preventDefault(),document.querySelector("form").dispatchEvent(new Event("submit",{cancelable:!0,bubbles:!0}))},className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[s.jsx("i",{className:"fas fa-save mr-2"}),"Update Server"]})]})]})}),C&&s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:s.jsxs("div",{className:"relative w-full max-w-lg mx-auto bg-white rounded-lg shadow-xl",children:[s.jsxs("div",{className:"px-6 py-4 bg-gray-50 border-b border-gray-200 rounded-t-lg flex justify-between items-center",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"bg-gray-100 p-2 rounded-lg",children:s.jsx("i",{className:"fas fa-edit text-blue-600 text-lg"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Edit Email Account"}),s.jsx("p",{className:"text-gray-500 text-sm",children:"Update account settings and limits"})]})]}),s.jsx("button",{onClick:()=>S(!1),className:"text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-md p-2 transition-colors",children:s.jsx("i",{className:"fas fa-times"})})]}),s.jsx("div",{className:"px-6 py-4",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),s.jsx("input",{type:"email",name:"email",value:T.email,onChange:L,className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"user@example.com",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password (leave blank to keep current)"}),s.jsx("input",{type:"password",name:"password",value:T.password,onChange:L,className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"New password (optional)"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hourly Limit"}),s.jsx("input",{type:"number",name:"hourly_limit",value:T.hourly_limit,onChange:L,className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",min:"0",max:"1000"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Daily Limit"}),s.jsx("input",{type:"number",name:"daily_limit",value:T.daily_limit,onChange:L,className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",min:"0",max:"10000"})]})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",name:"is_active",id:"edit_account_is_active",checked:T.is_active,onChange:L,className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),s.jsx("label",{htmlFor:"edit_account_is_active",className:"ml-2 block text-sm text-gray-700",children:"Active"})]})]})}),s.jsxs("div",{className:"flex justify-end px-6 py-4 space-x-3 bg-gray-50 rounded-b-lg border-t border-gray-200",children:[s.jsxs("button",{type:"button",onClick:()=>S(!1),className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[s.jsx("i",{className:"fas fa-times mr-2"}),"Cancel"]}),s.jsxs("button",{type:"button",onClick:async()=>{if(A&&T.email)try{const e=await i(`${l}/${A.serverId}/accounts/${A.accountId}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(T)}),s=await e.json();s.success?(v({type:"success",message:"Email account updated successfully!"}),S(!1),E(null),P({email:"",from_name:"",password:"",daily_limit:500,hourly_limit:50,is_active:!0}),q()):v({type:"error",message:s.message||"Failed to update email account."})}catch(e){v({type:"error",message:"Failed to update email account."})}else v({type:"error",message:"Email is required."})},className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[s.jsx("i",{className:"fas fa-save mr-2"}),"Update Account"]})]})]})})]})};export{d as default};
