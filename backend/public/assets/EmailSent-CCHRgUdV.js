import{a as e,j as s}from"./react-core-DPHBRSZI.js";import{T as a}from"./SkeletonLoader--gW7sJuH.js";import{A as t}from"./index-CyabgCnR.js";import"./react-dom-CzVnfz0w.js";import"./vendor-CNpwfz3n.js";import"./react-router-CQqd29q0.js";const r={pending:"bg-yellow-500",running:"bg-blue-600",paused:"bg-gray-500",completed:"bg-green-600",failed:"bg-red-600"},i=()=>{const[i,l]=e.useState([]),[n,d]=e.useState(!0),[o,c]=e.useState(null),x=e.useRef(!0),[m,p]=e.useState({page:1,rowsPerPage:10,total:0}),g=async()=>{x.current&&d(!0);try{const e=await fetch(t.API_MONITOR_CAMPAIGNS),s=await e.json();l(Array.isArray(s)?s:[]),p(e=>({...e,total:Array.isArray(s)?s.length:0}))}catch{c({type:"error",text:"Failed to load campaigns."})}d(!1),x.current=!1};e.useEffect(()=>{g();const e=setInterval(g,5e3);return()=>clearInterval(e)},[]);const h=Math.ceil(m.total/m.rowsPerPage),u=i.slice((m.page-1)*m.rowsPerPage,m.page*m.rowsPerPage);return e.useEffect(()=>{m.page>h&&h>0&&p(e=>({...e,page:1}))},[i,h,m.page]),s.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-7xl",children:[s.jsxs("h1",{className:"text-2xl font-bold text-gray-800 mb-6 flex items-center",children:[s.jsx("i",{className:"fas fa-chart-line mr-2 text-blue-600"}),"Campaign Monitor"]}),o&&s.jsxs("div",{className:"bg-red-100 border-l-4 border-red-500 text-red-700 p-4 mb-6 rounded-md flex items-start",children:[s.jsx("div",{className:"ml-3",children:s.jsx("p",{className:"text-sm font-medium",children:o.text})}),s.jsx("div",{className:"ml-auto pl-3",children:s.jsx("button",{onClick:()=>c(null),className:"text-gray-500 hover:text-gray-700",children:s.jsx("i",{className:"fas fa-times"})})})]}),s.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ID"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Progress"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Emails"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n?s.jsx(a,{rows:5,columns:5}):0===u.length?s.jsx("tr",{children:s.jsx("td",{colSpan:5,className:"px-6 py-4 text-center text-sm text-gray-500",children:"No campaigns found."})}):u.map(e=>{const a=Math.max(e.total_emails||0,1),t=Math.min(e.sent_emails||0,a),i=Math.round(t/a*100),l=(e.campaign_status||"pending").toLowerCase();return s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.campaign_id}),s.jsx("td",{className:"px-6 py-4",children:s.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.description})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:`status-badge px-2 py-1 rounded text-xs font-semibold ${r[l]||"bg-gray-400"} text-white`,children:e.campaign_status||"Not started"})}),s.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[s.jsx("div",{className:"progress-bar h-5 bg-gray-200 rounded",children:s.jsx("div",{className:"progress-fill bg-blue-600 h-5 rounded",style:{width:`${i}%`}})}),s.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[i,"% (",e.sent_emails||0,"/",e.total_emails||0,")"]})]}),s.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[s.jsxs("div",{children:["Total: ",e.total_emails||0]}),s.jsxs("div",{children:["Pending: ",e.pending_emails||0]}),s.jsxs("div",{children:["Sent: ",e.sent_emails||0]}),s.jsxs("div",{children:["Failed: ",e.failed_emails||0]})]})]},e.campaign_id)})})]})})}),m.total>0&&s.jsxs("div",{className:"flex flex-col items-center justify-center mt-6 px-1 gap-2",children:[s.jsx("div",{className:"flex items-center gap-4 mb-2",children:s.jsxs("div",{className:"text-xs sm:text-sm text-gray-500",children:["Showing"," ",s.jsx("span",{className:"font-medium",children:(m.page-1)*m.rowsPerPage+1})," ","to"," ",s.jsx("span",{className:"font-medium",children:Math.min(m.page*m.rowsPerPage,m.total)})," ","of ",s.jsx("span",{className:"font-medium",children:m.total})," ","campaigns"]})}),s.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[s.jsx("button",{onClick:()=>p(e=>({...e,page:1})),disabled:1===m.page,className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 transition-colors",children:s.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 19l-7-7 7-7m8 14l-7-7 7-7"})})}),s.jsx("button",{onClick:()=>p(e=>({...e,page:e.page-1})),disabled:1===m.page,className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 transition-colors",children:s.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})})}),s.jsxs("span",{className:"text-xs sm:text-sm font-medium text-gray-700",children:["Page ",m.page," of ",h]}),s.jsx("button",{onClick:()=>p(e=>({...e,page:Math.min(h,e.page+1)})),disabled:m.page>=h,className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 transition-colors",children:s.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})})}),s.jsx("button",{onClick:()=>p(e=>({...e,page:h})),disabled:m.page>=h,className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 transition-colors",children:s.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 5l7 7-7 7M5 5l7 7-7 7"})})}),s.jsx("div",{className:"flex items-center gap-1 ml-4",children:s.jsx("select",{id:"rowsPerPage",value:m.rowsPerPage,onChange:e=>{p(s=>({...s,rowsPerPage:Number(e.target.value),page:1}))},className:"border border-gray-300 rounded px-2 py-2 text-xs sm:text-sm",children:[10,25,50,100].map(e=>s.jsx("option",{value:e,children:e},e))})})]})]})]})};export{i as default};
