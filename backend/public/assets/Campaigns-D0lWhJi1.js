import{a as e,j as t,R as s}from"./react-core-DPHBRSZI.js";import{Q as a}from"./editor-Cr9jlNTK.js";import{A as l}from"./index-CyabgCnR.js";import"./react-dom-CzVnfz0w.js";import"./vendor-CNpwfz3n.js";import"./react-router-CQqd29q0.js";const i={toolbar:[[{header:[1,2,3,!1]}],["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],[{color:[]},{background:[]}],["link","image"],["clean"]]},r=["header","bold","italic","underline","strike","list","bullet","link","color","background","image"];function n(t){const s=e.useRef(t);return e.useEffect(()=>{s.current=t},[t]),s}const c="<p><br></p>";function o({value:s,onChange:l,modules:o,formats:d,placeholder:m,onImageUpload:x,uploadImageUrl:p,minHeight:u=200}){const h=e.useRef(null),g=e.useRef(null),b=e.useRef(null),[f,j]=e.useState(!1),y=n(l),N=n(x),v=e.useMemo(()=>o??i,[o]),w=e.useMemo(()=>d??r,[d]);return e.useEffect(()=>{if(!h.current||g.current)return;const e=h.current,t=e.parentElement?.querySelector(":scope > .ql-toolbar");t?.remove();const s=new a(e,{theme:"snow",modules:v,formats:w,placeholder:m});g.current=s,j(!0);const l=s.getModule("toolbar");l&&"container"in l&&(b.current=l.container,l.addHandler("image",async()=>{const e=document.createElement("input");e.type="file",e.accept="image/*",e.click(),e.onchange=async()=>{const t=e.files?.[0];if(!t)return;const a=s.getSelection(!0),l=a?.index??s.getLength();s.insertText(l,"Uploading image…");const i=new FormData;i.append("image",t);try{const e=await fetch(p,{method:"POST",body:i}),t=await e.json();s.deleteText(l,16),t.success?(s.insertEmbed(l,"image",t.url),s.setSelection({index:l+1,length:0}),N.current?.(t.path)):alert(`✗ Upload failed: ${t.message??"unknown error"}`)}catch(r){s.deleteText(l,16),r instanceof Error&&alert(`✗ Upload error: ${r.message}`)}}}));const i=()=>{if(!g.current)return;const e=g.current.root.innerHTML;y.current(e===c?"":e)};return s.on("text-change",i),()=>{s.off("text-change",i),b.current?.remove(),b.current=null,g.current=null,e.innerHTML="",j(!1)}},[w,v,m,p,y,N]),e.useEffect(()=>{if(!f||!g.current)return;const e=g.current,t=e.root.innerHTML,a=s||"";if(t===a||t===c&&""===a)return;const l=e.getSelection(),i=l?.index??e.getLength();e.setContents(e.clipboard.convert(a)),e.setSelection({index:Math.min(i,e.getLength()),length:0})},[f,s]),t.jsx("div",{className:"quill-editor-wrapper bg-white rounded-lg border border-gray-300",children:t.jsx("div",{ref:h,style:{minHeight:u}})})}const d={description:"",mail_subject:"",mail_body:"",attachment:null,existing_attachment:null,images:[],template_id:null,import_batch_id:null},m=({message:e,onClose:s})=>e&&t.jsxs("div",{className:`\n        fixed top-6 left-1/2 transform -translate-x-1/2\n        px-6 py-3 rounded-xl shadow-lg text-base font-bold\n        flex items-center gap-3\n        transition-all duration-300\n        backdrop-blur-md\n        ${"error"===e.type?"bg-red-50 border-2 border-red-500 text-red-700":"bg-green-50 border-2 border-green-500 text-green-700"}\n      `,style:{minWidth:250,maxWidth:600,zIndex:99999,boxShadow:"error"===e.type?"0 8px 32px 0 rgba(220, 38, 38, 0.4)":"0 8px 32px 0 rgba(34, 197, 94, 0.4)",background:"error"===e.type?"rgba(254, 226, 226, 0.95)":"rgba(220, 252, 231, 0.95)",borderRadius:"16px",backdropFilter:"blur(8px)",WebkitBackdropFilter:"blur(8px)"},role:"alert",children:[t.jsx("i",{className:"fas text-xl "+("error"===e.type?"fa-exclamation-circle text-red-600":"fa-check-circle text-green-600")}),t.jsx("span",{className:"flex-1",children:e.text}),t.jsx("button",{onClick:s,className:"ml-2 text-gray-500 hover:text-gray-700 focus:outline-none","aria-label":"Close",children:t.jsx("i",{className:"fas fa-times"})})]}),x=()=>{const[a,i]=e.useState([]),[r,n]=e.useState(!0),[c,x]=e.useState(!1),[p,u]=e.useState(!1),[h,g]=e.useState(d),[b,f]=e.useState(null),[j,y]=e.useState([]),[N,v]=e.useState(null),[w,_]=e.useState(null),[k,C]=e.useState([]),[S,E]=e.useState([]),[P,$]=e.useState(!1),[I,T]=e.useState(null),[D,M]=e.useState(!1),[A,F]=e.useState(!1),[O,L]=e.useState(""),[R,U]=e.useState(!1),[V,B]=e.useState({page:1,rowsPerPage:10,total:0}),W=l.BASE_URL,z=l.API_CAMPAIGNS,H=l.UPLOAD_IMAGE,q=s.useCallback(async()=>{try{const e=await fetch(`${W}/backend/includes/mail_templates.php?action=list`,{credentials:"include"}),t=await e.json();t.success&&C(t.templates.filter(e=>1==e.is_active||"1"===e.is_active))}catch(e){}},[W]),J=s.useCallback(async()=>{try{const e=await fetch(`${l.API_IMPORT_DATA}?action=list&source=campaign`,{credentials:"include"}),t=await e.json();t.success&&E(t.batches||[])}catch(e){}},[W]);e.useEffect(()=>{q()},[q]);const G=s.useCallback(async()=>{n(!0);try{const e=await fetch(z,{method:"GET",credentials:"include"});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const t=await e.json(),s=Array.isArray(t)?t:[];i(s),B(e=>({...e,total:s.length})),"error"===w?.type&&w?.text?.includes("Failed to load")&&_(null)}catch(e){i([]),B(e=>({...e,total:0})),_({type:"error",text:"Failed to load data: Network Error. Please check your connection."})}finally{n(!1)}},[z]);e.useEffect(()=>{G(),q(),J()},[G,q,J]);const K=e=>{const{name:t,value:s,files:a}=e.target;"attachment"===t?f(a[0]):g(e=>({...e,[t]:s}))},Q=e=>{const t=X(e);y(e=>[...e,t])},X=e=>{if(!e)return e;let t=e.replace(/^https?:\/\/[^/]+/i,"");return t=t.replace(/^\/verify_emails\/MailPilot_CRM(_S)?\/backend\//i,""),t=t.replace(/^\/backend\//i,""),t=t.replace(/^backend\//i,""),t.includes("storage/")&&!t.startsWith("storage/")&&(t=t.substring(t.indexOf("storage/"))),t=t.replace(/^\/+/,""),t},Y=e=>{if(!e)return e;let t=e;return t=t.replace(/http:\/\/localhost\/verify_emails\/MailPilot_CRM(_S)?\/backend\/(storage\/[^"'\s>]+)/gi,"$2"),t=t.replace(/\/verify_emails\/MailPilot_CRM(_S)?\/backend\/(storage\/[^"'\s>]+)/gi,"$2"),t=t.replace(/\/backend\/(storage\/[^"'\s>]+)/gi,"$1"),t},Z=e=>{if(!e)return[];const t=[],s=document.createElement("div");return s.innerHTML=e,s.querySelectorAll("img").forEach(e=>{let s=e.getAttribute("src");if(s&&s.includes("storage/images/")){const e=X(s);e&&!t.includes(e)&&t.push(e)}}),t},ee=e=>{if(!e)return e;let t=e.replace(/src=(["'])(storage\/images\/[^"']+)\1/gi,(e,t,s)=>`src=${t}${W}/backend/${s}${t}`);return t=t.replace(/src=(["'])\/backend\/(storage\/images\/[^"']+)\1/gi,(e,t,s)=>`src=${t}${W}/backend/${s}${t}`),t},te=async e=>{try{const t=`${z}&id=${e.campaign_id}`,s=await fetch(t,{credentials:"include"}),a=await s.json();if(!a||a.error)return void _({type:"error",text:"Failed to load campaign data."});v(e.campaign_id);const l=a.images_paths?JSON.parse(a.images_paths):[];let i=ee(a.mail_body||"");l.forEach(e=>{const t=`${W}/backend/${e}`;-1===i.indexOf(t)&&-1===i.indexOf(e)&&(i+=`<p><img src='${t}' style='max-width:300px;'/></p>`)}),g({description:a.description,mail_subject:a.mail_subject,mail_body:i,attachment:null,existing_attachment:a.attachment_path||null,images:l,template_id:a.template_id||null,import_batch_id:a.import_batch_id||null}),f(null),y([]),u(!0)}catch(t){_({type:"error",text:"Failed to load campaign data."})}},se=async e=>{i(t=>t.filter(t=>t.campaign_id!==e)),B(e=>({...e,total:e.total-1}));try{const t=`${z}&id=${e}`,s=await fetch(t,{method:"DELETE",credentials:"include"}),a=await s.json();a.success?_({type:"success",text:"Campaign deleted successfully!"}):(_({type:"error",text:a.message||"Failed to delete campaign."}),G())}catch{_({type:"error",text:"Failed to delete campaign."}),G()}},ae=async e=>{try{const t=`${z}&id=${e}`,s=await fetch(t,{credentials:"include"}),a=await s.json(),l=a.images_paths?JSON.parse(a.images_paths):[];let i=ee(a.mail_body||"");l.forEach(e=>{const t=`${W}/backend/${e}`;-1===i.indexOf(t)&&-1===i.indexOf(e)&&(i+=`<p><img src='${t}' style='max-width:300px;'/></p>`)}),g({description:a.description,mail_subject:a.mail_subject,mail_body:i,attachment:null,existing_attachment:a.attachment_path||null,images:l}),v(null),f(null),y([]),x(!0)}catch{_({type:"error",text:"Failed to load campaign for reuse."})}};e.useEffect(()=>{if(w){const e=setTimeout(()=>_(null),3e3);return()=>clearTimeout(e)}},[w]);const le=e=>{if(e?.mail_body_preview)return e.mail_body_preview;const t=e?.mail_body||"";if(!t)return"";const s=document.createElement("div");s.innerHTML=t;const a=(s.textContent||s.innerText||"").trim().split(/\s+/).filter(e=>e.length>0);return a.slice(0,30).join(" ")+(a.length>30?"...":"")},ie=async e=>{U(!0),F(!0),L("");try{const t=await(async(e,t=null)=>{try{if(e.template_id&&(e.import_batch_id||e.csv_list_id)){const s=await fetch(`${W}/backend/includes/mail_templates.php?action=get&template_id=${e.template_id}`,{credentials:"include"}),a=await s.json();if(a.success){let s=t;if(!s)if(e.import_batch_id){const t=await fetch(`${l.API_IMPORT_DATA}?action=get_batch&batch_id=${e.import_batch_id}`,{credentials:"include"}),a=await t.json();a.success&&a.recipients&&a.recipients.length>0&&(s=a.recipients[0].Emails)}else if(e.csv_list_id){const t=await fetch(`${W}/backend/includes/get_csv_list.php?list_id=${e.csv_list_id}&limit=1`,{credentials:"include"}),a=await t.json();a.emails&&a.emails.length>0&&(s=a.emails[0].raw_emailid)}const i=await fetch(`${W}/backend/includes/mail_templates.php?action=merge_preview`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({template_html:a.template.template_html,import_batch_id:e.import_batch_id,csv_list_id:e.csv_list_id})}),r=await i.json();if(r.success)return r.merged_html}}return e.mail_body||""}catch(s){return e.mail_body||""}})(e);L(t)}catch(t){L("<p>Error loading preview</p>")}finally{U(!1)}},re=Math.max(1,Math.ceil(V.total/V.rowsPerPage)),ne=a.slice((V.page-1)*V.rowsPerPage,V.page*V.rowsPerPage);return t.jsxs("div",{className:"container mx-auto mt-12 px-2 sm:px-4 py-8 max-w-7xl",children:[t.jsx(m,{message:w,onClose:()=>_(null)}),t.jsxs("div",{className:"flex justify-between items-center mb-6",children:[t.jsxs("h1",{className:"text-2xl font-bold text-gray-800",children:[t.jsx("i",{className:"fas fa-bullhorn mr-2 text-blue-600"}),"Email Campaigns"]}),t.jsxs("button",{onClick:()=>{g(d),x(!0)},className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md flex items-center",children:[t.jsx("i",{className:"fas fa-plus mr-2"})," Add Campaign"]})]}),t.jsx("div",{className:"block sm:hidden",children:ne.map(e=>t.jsxs("div",{className:"bg-white rounded-2xl shadow p-4 mb-4 flex flex-col",children:[t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsxs("div",{className:"text-lg font-bold text-gray-900 mb-1",children:["ID: ",e.campaign_id]}),t.jsx("div",{className:"font-semibold text-gray-900",children:"Description:"}),t.jsx("div",{className:"text-gray-600 text-base mb-2 break-words",children:e.description})]}),t.jsxs("div",{className:"flex flex-col gap-2 items-end ml-2",children:[t.jsx("button",{onClick:()=>ie(e),className:"text-purple-600 hover:text-purple-800 p-1 rounded",title:"View Email Preview",children:t.jsx("i",{className:"fas fa-eye text-xl"})}),t.jsx("button",{onClick:()=>te(e),className:"text-blue-600 hover:text-blue-800 p-1 rounded",title:"Edit",children:t.jsx("i",{className:"fas fa-edit text-xl"})}),t.jsx("button",{onClick:()=>ae(e.campaign_id),className:"text-green-600 hover:text-green-800 p-1 rounded",title:"Reuse",children:t.jsx("i",{className:"fas fa-copy text-xl"})}),t.jsx("button",{onClick:()=>{window.confirm("Are you sure you want to delete this campaign?")&&se(e.campaign_id)},className:"text-red-600 hover:text-red-800 p-1 rounded",title:"Delete",children:t.jsx("i",{className:"fas fa-trash text-xl"})})]})]}),t.jsxs("div",{className:"mt-2",children:[t.jsx("div",{className:"font-semibold text-gray-900 text-xs uppercase tracking-wide mb-1",children:"Subject:"}),t.jsx("div",{className:"text-gray-700 text-sm break-words mb-3",children:e.mail_subject}),t.jsx("div",{className:"font-semibold text-gray-900 text-xs uppercase tracking-wide mb-1",children:"Email Preview:"}),t.jsx("div",{className:"text-gray-600 text-sm leading-relaxed",style:{display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",overflow:"hidden"},children:le(e)}),e.attachment_path&&t.jsx("div",{className:"mt-2 flex items-center gap-2",children:t.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[t.jsx("i",{className:"fas fa-paperclip mr-1"}),"Has Attachment"]})})]})]},e.campaign_id))}),t.jsx("div",{className:"hidden sm:block bg-white rounded-lg shadow overflow-hidden",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"w-16 px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ID"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subject"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email Preview"}),t.jsx("th",{className:"w-40 px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r?Array.from({length:V.rowsPerPage}).map((e,s)=>t.jsxs("tr",{className:"animate-pulse",children:[t.jsx("td",{className:"px-4 py-3",children:t.jsx("div",{className:"h-4 bg-gray-200 rounded w-8"})}),t.jsx("td",{className:"px-4 py-3",children:t.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"})}),t.jsx("td",{className:"px-4 py-3",children:t.jsx("div",{className:"h-4 bg-gray-200 rounded w-2/3"})}),t.jsxs("td",{className:"px-4 py-3",children:[t.jsx("div",{className:"h-4 bg-gray-200 rounded w-full mb-1"}),t.jsx("div",{className:"h-4 bg-gray-200 rounded w-5/6"})]}),t.jsx("td",{className:"px-4 py-3",children:t.jsxs("div",{className:"flex justify-end space-x-2",children:[t.jsx("div",{className:"h-8 w-8 bg-gray-200 rounded"}),t.jsx("div",{className:"h-8 w-8 bg-gray-200 rounded"}),t.jsx("div",{className:"h-8 w-8 bg-gray-200 rounded"})]})})]},s)):0===a.length?t.jsx("tr",{children:t.jsx("td",{colSpan:5,className:"px-6 py-4 text-center text-sm text-gray-500",children:"No campaigns found. Add one to get started."})}):ne.map((e,s)=>t.jsxs("tr",{className:"hover:bg-gray-50 transition-colors duration-150",children:[t.jsx("td",{className:"px-2 sm:px-4 py-2 sm:py-3 whitespace-nowrap text-xs sm:text-sm font-medium text-gray-500",children:(V.page-1)*V.rowsPerPage+s+1}),t.jsx("td",{className:"px-2 sm:px-4 py-2 sm:py-3",children:t.jsx("div",{className:"text-xs sm:text-sm font-medium text-gray-900 truncate max-w-[120px] sm:max-w-xs",children:e.description})}),t.jsx("td",{className:"px-2 sm:px-4 py-2 sm:py-3",children:t.jsx("div",{className:"text-xs sm:text-sm text-gray-900 truncate max-w-[120px] sm:max-w-xs",children:e.mail_subject})}),t.jsxs("td",{className:"px-2 sm:px-4 py-2 sm:py-3 hidden md:table-cell",children:[t.jsx("div",{className:"text-sm text-gray-600 max-w-xs line-clamp-2",title:le(e),style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis"},children:le(e)}),e.attachment_path&&t.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 mt-1 rounded text-xs font-medium bg-blue-100 text-blue-800",children:[t.jsx("i",{className:"fas fa-paperclip mr-1"}),"Attachment"]})]}),t.jsx("td",{className:"px-2 sm:px-4 py-2 sm:py-3 whitespace-nowrap text-right text-sm font-medium",children:t.jsxs("div",{className:"flex justify-end space-x-1 sm:space-x-2",children:[t.jsx("button",{onClick:()=>ie(e),className:"text-purple-600 hover:text-purple-800 p-1 rounded hover:bg-purple-50",title:"View Email Preview",children:t.jsx("i",{className:"fas fa-eye"})}),t.jsx("button",{onClick:()=>te(e),className:"text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-50",title:"Edit",children:t.jsx("i",{className:"fas fa-edit"})}),t.jsx("button",{onClick:()=>ae(e.campaign_id),className:"text-green-600 hover:text-green-800 p-1 rounded hover:bg-green-50",title:"Reuse",children:t.jsx("i",{className:"fas fa-copy"})}),t.jsx("button",{onClick:()=>{window.confirm("Are you sure you want to delete this campaign?")&&se(e.campaign_id)},className:"text-red-600 hover:text-red-800 p-1 rounded hover:bg-red-50",title:"Delete",children:t.jsx("i",{className:"fas fa-trash"})})]})})]},e.campaign_id))})]})})}),a.length>0&&t.jsxs("div",{className:"flex flex-col items-center justify-center mt-6 px-1 gap-2",children:[t.jsxs("div",{className:"text-xs sm:text-sm text-gray-500 mb-2",children:["Showing"," ",t.jsx("span",{className:"font-medium",children:(V.page-1)*V.rowsPerPage+1})," ","to"," ",t.jsx("span",{className:"font-medium",children:Math.min(V.page*V.rowsPerPage,V.total)})," ","of ",t.jsx("span",{className:"font-medium",children:V.total})," ","campaigns"]}),t.jsxs("div",{className:"flex flex-wrap items-center gap-2 pb-5",children:[t.jsx("button",{onClick:()=>B(e=>({...e,page:1})),disabled:1===V.page,className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 transition-colors",children:t.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 19l-7-7 7-7m8 14l-7-7 7-7"})})}),t.jsx("button",{onClick:()=>B(e=>({...e,page:e.page-1})),disabled:1===V.page,className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 transition-colors",children:t.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})})}),t.jsxs("span",{className:"text-xs sm:text-sm font-medium text-gray-700",children:["Page ",V.page," of ",re]}),t.jsx("button",{onClick:()=>B(e=>({...e,page:Math.min(re,e.page+1)})),disabled:V.page>=re,className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 transition-colors",children:t.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})})}),t.jsx("button",{onClick:()=>B(e=>({...e,page:re})),disabled:V.page>=re,className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 transition-colors",children:t.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 5l7 7-7 7M5 5l7 7-7 7"})})}),t.jsx("select",{value:V.rowsPerPage,onChange:e=>B(t=>({...t,rowsPerPage:Number(e.target.value),page:1})),className:"border p-2 rounded-lg text-xs sm:text-sm bg-white focus:ring-blue-500 focus:border-blue-500 transition-colors",children:[10,25,50,100].map(e=>t.jsx("option",{value:e,children:e},e))})]})]}),c&&t.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm overflow-y-auto h-full w-full z-50",children:t.jsxs("div",{className:"min-h-screen px-4 text-center",children:[t.jsx("span",{className:"inline-block h-screen align-middle","aria-hidden":"true",children:"​"}),t.jsxs("div",{className:"inline-block w-11/12 md:w-3/4 lg:w-2/3 max-w-5xl my-8 text-left align-middle transition-all transform bg-white shadow-2xl rounded-xl",children:[t.jsx("div",{className:"sticky top-0 z-10 bg-white px-6 py-4 border-b border-gray-200 rounded-t-xl",children:t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("h3",{className:"text-xl font-semibold text-gray-900 flex items-center gap-2",children:[t.jsx("i",{className:"fas fa-plus-circle text-blue-600"}),"Add New Campaign"]}),t.jsx("button",{onClick:()=>x(!1),className:"text-gray-400 hover:text-gray-500 p-2 rounded-lg hover:bg-gray-100 transition-colors","aria-label":"Close",children:t.jsx("i",{className:"fas fa-times text-lg"})})]})}),t.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),!(h.template_id||h.mail_body&&""!==h.mail_body.trim()))return void _({type:"error",text:"Please select a template or compose an email body."});const t=Y(h.mail_body),s=Z(t),a=new FormData;a.append("description",h.description),a.append("mail_subject",h.mail_subject),a.append("mail_body",t||""),a.append("send_as_html","1"),h.template_id&&a.append("template_id",h.template_id),h.import_batch_id&&a.append("import_batch_id",h.import_batch_id),b&&a.append("attachment",b),a.append("images_json",JSON.stringify(s));try{const e=await fetch(z,{method:"POST",body:a,credentials:"include"}),t=await e.json();t.success?(_({type:"success",text:"Campaign added successfully!"}),x(!1),g(d),f(null),y([]),G()):_({type:"error",text:t.message||"Failed to add campaign."})}catch{_({type:"error",text:"Failed to add campaign."})}},encType:"multipart/form-data",className:"px-6 py-4",children:[t.jsx("div",{className:"space-y-6",children:t.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Description"}),t.jsx("input",{type:"text",name:"description",required:!0,className:"block w-full px-4 py-3 bg-gray-50 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500 transition-colors sm:text-sm",placeholder:"Enter campaign description",value:h.description,onChange:K})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Email Subject"}),t.jsx("input",{type:"text",name:"mail_subject",required:!0,className:"block w-full px-4 py-3 bg-gray-50 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500 transition-colors sm:text-sm",placeholder:"Enter email subject line",value:h.mail_subject,onChange:K})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:[t.jsx("i",{className:"fas fa-file-code mr-2 text-blue-600"}),"Mail Template (Optional)"]}),t.jsxs("select",{name:"template_id",className:"block w-full px-4 py-3 bg-gray-50 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500 transition-colors sm:text-sm",value:h.template_id||"",onChange:e=>{const t=e.target.value?parseInt(e.target.value):null;g(e=>({...e,template_id:t}))},children:[t.jsx("option",{value:"",children:"No Template (Use Email Body below)"}),k.map(e=>t.jsxs("option",{value:e.template_id,children:[e.template_name," ",e.merge_fields&&e.merge_fields.length>0?`(${e.merge_fields.length} fields)`:""]},e.template_id))]}),h.template_id&&t.jsxs("div",{className:"mt-2 p-3 bg-green-50 border border-green-200 rounded-lg",children:[t.jsxs("p",{className:"text-sm text-green-800",children:[t.jsx("i",{className:"fas fa-check-circle mr-2"}),t.jsx("strong",{children:"Template Selected:"})," This template will be used as the email body. It will automatically merge with CSV data fields like [[Amount]], [[Days]], [[BilledName]], etc."]}),t.jsxs("p",{className:"text-xs text-green-700 mt-1",children:[t.jsx("i",{className:"fas fa-database mr-1"}),"Make sure your CSV file has columns matching the template merge fields."]})]}),!h.template_id&&t.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:[t.jsx("i",{className:"fas fa-info-circle mr-1"}),"Select a template above to use pre-designed HTML with CSV data merging, or compose email body below."]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:[t.jsx("i",{className:"fas fa-database mr-2 text-purple-600"}),"Import Recipients Data (Optional)"]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("select",{name:"import_batch_id",className:"flex-1 px-4 py-3 bg-gray-50 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500 transition-colors sm:text-sm",value:h.import_batch_id||"",onChange:e=>{g(t=>({...t,import_batch_id:e.target.value||null}))},children:[t.jsx("option",{value:"",children:"No Imported Data (Use CSV list)"}),S.map(e=>t.jsxs("option",{value:e.import_batch_id,children:[e.import_filename," (",e.record_count," records)"]},e.import_batch_id))]}),t.jsxs("button",{type:"button",onClick:()=>$(!0),className:"px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors",title:"Import new Excel/CSV file",children:[t.jsx("i",{className:"fas fa-upload mr-2"}),"Import"]})]}),h.import_batch_id&&t.jsxs("div",{className:"mt-2 p-3 bg-purple-50 border border-purple-200 rounded-lg",children:[t.jsxs("p",{className:"text-sm text-purple-800",children:[t.jsx("i",{className:"fas fa-check-circle mr-2"}),t.jsx("strong",{children:"Imported Data Selected:"})," Template merge fields will use data from this import."]}),t.jsxs("p",{className:"text-xs text-purple-700 mt-1",children:[t.jsx("i",{className:"fas fa-info-circle mr-1"}),"Emails will be sent to all recipients in this import batch."]})]}),!h.import_batch_id&&t.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:[t.jsx("i",{className:"fas fa-info-circle mr-1"}),"Import Excel data or use existing CSV lists for recipients."]})]}),!h.template_id&&t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:["Email Body ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("div",{className:"bg-white border border-gray-300 rounded-lg overflow-hidden shadow-sm",style:{zIndex:1001},children:t.jsx(o,{value:h.mail_body,onChange:e=>g(t=>({...t,mail_body:e})),onImageUpload:Q,uploadImageUrl:H,placeholder:"Compose your email content here..."})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Attachment (Optional)"}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsxs("label",{className:"flex-1",children:[t.jsx("span",{className:"sr-only",children:"Choose file"}),t.jsx("input",{type:"file",name:"attachment",onChange:K,accept:".pdf,.jpg,.jpeg,.png,.doc,.docx,.xls,.xlsx,.csv,.txt",id:"attachment-input",className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 focus:outline-none"})]}),b&&t.jsx("button",{type:"button",onClick:()=>f(null),className:"p-2 text-gray-400 hover:text-gray-500",title:"Remove attachment",children:t.jsx("i",{className:"fas fa-times"})})]}),b&&t.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:[t.jsx("i",{className:"fas fa-paperclip mr-2"}),b.name]})]})]})}),t.jsxs("div",{className:"mt-6 border-t border-gray-200 pt-6 flex items-center justify-end gap-3",children:[t.jsx("button",{type:"button",onClick:()=>x(!1),className:"px-4 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",children:"Cancel"}),t.jsxs("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors inline-flex items-center",children:[t.jsx("i",{className:"fas fa-save mr-2"}),"Save Campaign"]})]})]})]})]})}),p&&t.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm overflow-y-auto h-full w-full z-50",children:t.jsxs("div",{className:"min-h-screen px-4 text-center",children:[t.jsx("span",{className:"inline-block h-screen align-middle","aria-hidden":"true",children:"​"}),t.jsxs("div",{className:"inline-block w-11/12 md:w-3/4 lg:w-2/3 max-w-5xl my-8 text-left align-middle transition-all transform bg-white shadow-2xl rounded-xl",children:[t.jsx("div",{className:"sticky top-0 z-10 bg-white px-6 py-4 border-b border-gray-200 rounded-t-xl",children:t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("h3",{className:"text-xl font-semibold text-gray-900 flex items-center gap-2",children:[t.jsx("i",{className:"fas fa-edit text-blue-600"}),"Edit Campaign"]}),t.jsx("button",{onClick:()=>u(!1),className:"text-gray-400 hover:text-gray-500 p-2 rounded-lg hover:bg-gray-100 transition-colors","aria-label":"Close",children:t.jsx("i",{className:"fas fa-times text-lg"})})]})}),t.jsxs("form",{onSubmit:async e=>{e.preventDefault();const t=Y(h.mail_body),s=new FormData;s.append("description",h.description),s.append("mail_subject",h.mail_subject),s.append("mail_body",t||""),s.append("send_as_html","1"),h.template_id&&s.append("template_id",h.template_id),h.import_batch_id&&s.append("import_batch_id",h.import_batch_id),b&&s.append("attachment",b);const a=Z(t);s.append("images_json",JSON.stringify(a)),s.append("_method","PUT");try{const e=`${z}&id=${N}`,t=await fetch(e,{method:"POST",body:s,credentials:"include"}),a=await t.json();a.success?(_({type:"success",text:"Campaign updated successfully!"}),u(!1),g(d),f(null),y([]),G()):_({type:"error",text:a.message||"Failed to update campaign."})}catch{_({type:"error",text:"Failed to update campaign."})}},encType:"multipart/form-data",className:"px-6 py-4",children:[t.jsx("div",{className:"space-y-6",children:t.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Description"}),t.jsx("input",{type:"text",name:"description",required:!0,className:"block w-full px-4 py-3 bg-gray-50 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500 transition-colors sm:text-sm",value:h.description,onChange:K})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Email Subject"}),t.jsx("input",{type:"text",name:"mail_subject",required:!0,className:"block w-full px-4 py-3 bg-gray-50 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500 transition-colors sm:text-sm",value:h.mail_subject,onChange:K})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:[t.jsx("i",{className:"fas fa-file-code mr-2 text-blue-600"}),"Mail Template (Optional)"]}),t.jsxs("select",{name:"template_id",className:"block w-full px-4 py-3 bg-gray-50 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500 transition-colors sm:text-sm",value:h.template_id||"",onChange:e=>{const t=e.target.value?parseInt(e.target.value):null;g(e=>({...e,template_id:t}))},children:[t.jsx("option",{value:"",children:"No Template (Use Email Body below)"}),k.map(e=>t.jsxs("option",{value:e.template_id,children:[e.template_name," ",e.merge_fields&&e.merge_fields.length>0?`(${e.merge_fields.length} fields)`:""]},e.template_id))]}),h.template_id&&!h.import_batch_id&&t.jsxs("div",{className:"mt-2 p-3 bg-yellow-50 border border-yellow-300 rounded-lg",children:[t.jsxs("p",{className:"text-sm text-yellow-800",children:[t.jsx("i",{className:"fas fa-exclamation-triangle mr-2"}),t.jsx("strong",{children:"Warning:"})," Template selected but no Excel data imported!"]}),t.jsxs("p",{className:"text-xs text-yellow-700 mt-1",children:[t.jsx("i",{className:"fas fa-arrow-down mr-1"}),"Please select an imported data batch below or import a new Excel file."]})]}),h.template_id&&h.import_batch_id&&t.jsx("div",{className:"mt-2 p-3 bg-green-50 border border-green-200 rounded-lg",children:t.jsxs("p",{className:"text-sm text-green-800",children:[t.jsx("i",{className:"fas fa-check-circle mr-2"}),t.jsx("strong",{children:"Template + Excel Data:"})," Ready to merge!"]})}),!h.template_id&&t.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:[t.jsx("i",{className:"fas fa-info-circle mr-1"}),"If template is selected, it will merge with Excel data fields like [[Amount]], [[Days]], etc."]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:[t.jsx("i",{className:"fas fa-database mr-2 text-purple-600"}),"Import Recipients Data ",h.template_id&&t.jsx("span",{className:"text-red-500",children:"* (Required for Template)"})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("select",{name:"import_batch_id",className:"flex-1 px-4 py-3 bg-gray-50 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500 transition-colors sm:text-sm",value:h.import_batch_id||"",onChange:e=>{g(t=>({...t,import_batch_id:e.target.value||null}))},children:[t.jsx("option",{value:"",children:"No Imported Data (Use CSV list)"}),S.map(e=>t.jsxs("option",{value:e.import_batch_id,children:[e.import_filename," (",e.record_count," records)"]},e.import_batch_id))]}),t.jsxs("button",{type:"button",onClick:()=>$(!0),className:"px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors",title:"Import new Excel/CSV file",children:[t.jsx("i",{className:"fas fa-upload mr-2"}),"Import"]})]}),h.import_batch_id&&t.jsxs("div",{className:"mt-2 p-3 bg-purple-50 border border-purple-200 rounded-lg",children:[t.jsxs("p",{className:"text-sm text-purple-800",children:[t.jsx("i",{className:"fas fa-check-circle mr-2"}),t.jsx("strong",{children:"Imported Data Selected:"})," Template merge fields will use data from this import."]}),t.jsxs("p",{className:"text-xs text-purple-700 mt-1",children:[t.jsx("i",{className:"fas fa-info-circle mr-1"}),"Emails will be sent to all recipients in this import batch."]})]}),!h.import_batch_id&&!h.template_id&&t.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:[t.jsx("i",{className:"fas fa-info-circle mr-1"}),"Import Excel data or use existing CSV lists for recipients."]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Email Body (Use image button in toolbar to add images)"}),t.jsx("div",{className:"bg-white border border-gray-300 rounded-lg overflow-hidden shadow-sm",style:{zIndex:1001},children:t.jsx(o,{value:h.mail_body,onChange:e=>g(t=>({...t,mail_body:e})),onImageUpload:Q,uploadImageUrl:H,placeholder:"Update your email content here..."})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Attachment (Optional)"}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsxs("label",{className:"flex-1",children:[t.jsx("span",{className:"sr-only",children:"Choose file"}),t.jsx("input",{type:"file",name:"attachment",onChange:K,accept:".pdf,.jpg,.jpeg,.png,.doc,.docx,.xls,.xlsx,.csv,.txt",id:"edit-attachment-input",className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 focus:outline-none"})]}),b&&t.jsx("button",{type:"button",onClick:()=>f(null),className:"p-2 text-gray-400 hover:text-gray-500",title:"Remove attachment",children:t.jsx("i",{className:"fas fa-times"})})]}),b&&t.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:[t.jsx("i",{className:"fas fa-paperclip mr-2"}),b.name]}),!b&&h.existing_attachment&&t.jsxs("div",{className:"mt-2 text-sm text-gray-600 border-t pt-2",children:[t.jsx("p",{className:"font-medium text-gray-700 mb-1",children:"Existing attachment:"}),t.jsxs("div",{className:"flex items-center justify-between bg-gray-50 rounded px-3 py-2",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx("i",{className:"fas fa-file mr-2 text-blue-600"}),t.jsx("span",{className:"text-xs",children:h.existing_attachment.split("/").pop()})]}),t.jsxs("a",{href:`${W}/backend/${h.existing_attachment}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 text-xs",children:[t.jsx("i",{className:"fas fa-download"})," Download"]})]}),t.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[t.jsx("i",{className:"fas fa-info-circle mr-1"}),"Upload a new file to replace this attachment"]})]})]})]})}),t.jsxs("div",{className:"mt-6 border-t border-gray-200 pt-6 flex items-center justify-end gap-3",children:[t.jsx("button",{type:"button",onClick:()=>u(!1),className:"px-4 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",children:"Cancel"}),t.jsxs("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors inline-flex items-center",children:[t.jsx("i",{className:"fas fa-save mr-2"}),"Update Campaign"]})]})]})]})]})}),P&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:t.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[t.jsxs("div",{className:"sticky top-0 bg-white border-b px-6 py-4 flex justify-between items-center z-10",children:[t.jsxs("h2",{className:"text-xl font-bold text-gray-800",children:[t.jsx("i",{className:"fas fa-upload mr-2 text-purple-600"}),"Import Recipients Data"]}),t.jsx("button",{onClick:()=>{$(!1),T(null)},className:"text-gray-500 hover:text-gray-700",children:t.jsx("i",{className:"fas fa-times text-xl"})})]}),t.jsxs("div",{className:"px-6 py-4",children:[t.jsxs("div",{className:"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[t.jsxs("h3",{className:"font-semibold text-blue-900 mb-2",children:[t.jsx("i",{className:"fas fa-info-circle mr-2"}),"Instructions:"]}),t.jsxs("ul",{className:"text-sm text-blue-800 space-y-1 ml-4",children:[t.jsx("li",{children:"• Upload Excel (.xlsx, .xls) or CSV file directly"}),t.jsxs("li",{children:["• File must have an ",t.jsx("strong",{children:'"email"'})," column"]}),t.jsx("li",{children:"• Supported columns: name, company, phone, amount, days, bill_number, bill_date, executive_name, executive_contact"}),t.jsx("li",{children:"• Any additional columns will be stored and available for templates"})]})]}),t.jsxs("div",{className:"mb-4",children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:[t.jsx("i",{className:"fas fa-file-excel mr-2 text-green-600"}),"Select Excel or CSV File"]}),t.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-purple-400 transition-colors",children:[t.jsx("input",{type:"file",accept:".csv,.xlsx,.xls",onChange:e=>T(e.target.files[0]),className:"hidden",id:"csvFileInput"}),t.jsxs("label",{htmlFor:"csvFileInput",className:"cursor-pointer",children:[t.jsx("div",{className:"text-gray-400 mb-2",children:t.jsx("i",{className:"fas fa-cloud-upload-alt text-5xl"})}),t.jsx("p",{className:"text-gray-600 font-medium",children:"Click to select Excel or CSV file"}),t.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Supports .xlsx, .xls, .csv"})]})]}),I&&t.jsxs("div",{className:"mt-3 p-3 bg-green-50 border border-green-200 rounded-lg flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx("i",{className:`fas ${I.name.endsWith(".csv")?"fa-file-csv":"fa-file-excel"} text-green-600 text-2xl mr-3`}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-gray-900",children:I.name}),t.jsxs("p",{className:"text-sm text-gray-600",children:[(I.size/1024).toFixed(2)," KB"]})]})]}),t.jsx("button",{onClick:()=>T(null),className:"text-red-500 hover:text-red-700",children:t.jsx("i",{className:"fas fa-times"})})]})]}),t.jsxs("div",{className:"flex justify-end gap-3",children:[t.jsx("button",{type:"button",onClick:()=>{$(!1),T(null)},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),t.jsx("button",{type:"button",onClick:async()=>{if(!I)return void _({type:"error",text:"Please select a CSV or Excel file to import"});const e=I.name.split(".").pop().toLowerCase();if(!["csv","xlsx","xls"].includes(e))return void _({type:"error",text:"Please select a CSV or Excel (.xlsx, .xls) file"});M(!0);const t=new FormData;t.append("csv_file",I);try{const e=await fetch(`${W}/backend/api/import_recipients.php`,{method:"POST",body:t,credentials:"include"}),s=await e.json();s.success&&"success"===s.status?(_({type:"success",text:`✓ Imported ${s.data.imported} records! Batch ID: ${s.data.import_batch_id}`}),$(!1),T(null),J()):_({type:"error",text:s.error||s.message||"Import failed"})}catch(s){_({type:"error",text:"Failed to import file: "+s.message})}finally{M(!1)}},disabled:!I||D,className:"px-6 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:D?t.jsxs(t.Fragment,{children:[t.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"Importing..."]}):t.jsxs(t.Fragment,{children:[t.jsx("i",{className:"fas fa-upload mr-2"}),"Import Data"]})})]})]})]})}),A&&t.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm overflow-y-auto h-full w-full z-50",children:t.jsxs("div",{className:"min-h-screen px-4 text-center",children:[t.jsx("span",{className:"inline-block h-screen align-middle","aria-hidden":"true",children:"​"}),t.jsxs("div",{className:"inline-block w-11/12 md:w-4/5 lg:w-3/4 max-w-6xl my-8 text-left align-middle transition-all transform bg-white shadow-2xl rounded-xl",children:[t.jsx("div",{className:"sticky top-0 z-10 bg-white px-6 py-4 border-b border-gray-200 rounded-t-xl",children:t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("h3",{className:"text-xl font-semibold text-gray-900 flex items-center gap-2",children:[t.jsx("i",{className:"fas fa-eye text-purple-600"}),"Email Preview with Merged Data"]}),t.jsx("button",{onClick:()=>F(!1),className:"text-gray-400 hover:text-gray-500 p-2 rounded-lg hover:bg-gray-100 transition-colors","aria-label":"Close",children:t.jsx("i",{className:"fas fa-times text-lg"})})]})}),t.jsx("div",{className:"px-6 py-4",children:R?t.jsxs("div",{className:"flex items-center justify-center py-12",children:[t.jsx("i",{className:"fas fa-spinner fa-spin text-4xl text-purple-600"}),t.jsx("span",{className:"ml-3 text-gray-600",children:"Loading preview..."})]}):t.jsx("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:t.jsx("iframe",{srcDoc:O,className:"w-full border-0 rounded-lg bg-white",style:{minHeight:"500px",height:"70vh"},title:"Email Preview",sandbox:"allow-same-origin"})})}),t.jsx("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-200 rounded-b-xl",children:t.jsx("div",{className:"flex justify-end",children:t.jsx("button",{onClick:()=>F(!1),className:"px-6 py-2 bg-gray-200 hover:bg-gray-300 text-gray-800 rounded-lg transition-colors",children:"Close"})})})]})]})})]})};export{x as default};
