import{a as e,j as s,R as a}from"./react-core-DPHBRSZI.js";import{a as t}from"./axios-4m6V5CeU.js";import{C as l}from"./SkeletonLoader--gW7sJuH.js";import{A as r}from"./index-zhHi7qea.js";import"./react-dom-CzVnfz0w.js";import"./vendor-CNpwfz3n.js";import"./react-router-CQqd29q0.js";const i=t.create({headers:{"Content-Type":"application/json"},withCredentials:!0});i.interceptors.request.use(e=>{const s=localStorage.getItem("mailpilot_token"),a=localStorage.getItem("mailpilot_token_expiry");if(a){const e=new Date(a).getTime();if(Date.now()>e)return localStorage.removeItem("mailpilot_user"),localStorage.removeItem("mailpilot_token"),localStorage.removeItem("mailpilot_token_expiry"),window.location.pathname.includes("/login")||(window.location.href="/login"),Promise.reject(new Error("Session expired"))}return s&&(e.headers.Authorization=`Bearer ${s}`),e},e=>Promise.reject(e)),i.interceptors.response.use(e=>e,e=>(401===e.response?.status&&(localStorage.removeItem("mailpilot_user"),localStorage.removeItem("mailpilot_token"),localStorage.removeItem("mailpilot_token_expiry"),window.location.pathname.includes("/login")||(window.location.href="/login")),Promise.reject(e)));const n=r.API_MASTER_CAMPAIGNS,c=()=>{const[a,t]=e.useState([]),[c,d]=e.useState(!0),[x,p]=e.useState(null),[g,u]=e.useState({}),[h,f]=e.useState({}),[b,j]=e.useState([]),[y,N]=e.useState({}),[v,w]=e.useState(!1),[_,k]=e.useState(null),[C,S]=e.useState(""),[P,E]=e.useState(!1),[I,L]=e.useState(null),[F,M]=e.useState(!1),[A,B]=e.useState(0),[V,T]=e.useState(""),[$,W]=e.useState({page:1,rowsPerPage:10,total:0});e.useEffect(()=>{if(x){const e=setTimeout(()=>p(null),3e3);return()=>clearTimeout(e)}},[x]);const z=e.useCallback(async()=>{try{const e=await i.get(r.GET_CSV_LIST,{params:{limit:"all"}});e.data,e.data&&e.data.success&&Array.isArray(e.data.data)?(e.data.data.length,j(e.data.data)):j([])}catch(e){j([])}},[]);e.useEffect(()=>{z()},[z]);const D=e.useCallback(async()=>{try{const e=await i.post(n,{action:"list"});if(!e?.data)throw new Error("No response data");if(!1===e.data.success)throw new Error(e.data.message||"API returned failure");const s=e.data.data&&e.data.data.campaigns||[];return t(s),W(e=>({...e,total:s.length})),d(!1),s}catch(e){return p({type:"error",text:`Failed to load data: ${e?.response?.data?.message||e?.message||"Unknown error"}`}),d(!1),[]}},[]),G=e.useMemo(()=>a.some(e=>"running"===e.campaign_status),[a]);e.useEffect(()=>{D();const e=G?5e3:3e4;let s;const a=()=>{document.hidden?clearInterval(s):(D(),s=setInterval(D,e))};return s=setInterval(D,e),document.addEventListener("visibilitychange",a),()=>{clearInterval(s),document.removeEventListener("visibilitychange",a)}},[D,G]);const R=e.useCallback(async e=>{try{const s=await i.post(n,{action:"email_counts",campaign_id:e});if(!1===s?.data?.success)throw new Error(s.data.message||"Failed to get counts");f(a=>({...a,[e]:s.data.data||s.data}))}catch(s){p({type:"error",text:"Failed to fetch email counts"})}},[]);e.useEffect(()=>{if(!G)return;const e=setInterval(()=>{t(e=>(u(s=>(e.forEach(e=>{"running"===e.campaign_status&&s[e.campaign_id]&&R(e.campaign_id)}),s)),e))},3e3);return()=>clearInterval(e)},[G,R]);const U=e.useMemo(()=>Math.max(1,Math.ceil($.total/$.rowsPerPage)),[$.total,$.rowsPerPage]),H=e.useMemo(()=>a.slice(($.page-1)*$.rowsPerPage,$.page*$.rowsPerPage),[a,$.page,$.rowsPerPage]),q=e.useCallback(async e=>{u(s=>{const a=!s[e];return a&&f(s=>(s[e]||R(e),s)),{...s,[e]:a}})},[R]),J=e.useCallback(async e=>{try{const s=await i.post(n,{action:"start_campaign",campaign_id:e});if(!1===s?.data?.success)throw new Error(s.data.message||"Failed to start campaign");p({type:"success",text:s.data.message||"Campaign started"}),await D()}catch(s){p({type:"error",text:s.response?.data?.error||s.message||"Failed to start campaign"})}},[D]),K=e.useCallback(async e=>{try{const s=await i.post(n,{action:"pause_campaign",campaign_id:e});if(!1===s?.data?.success)throw new Error(s.data.message||"Failed to pause campaign");p({type:"success",text:s.data.message||"Campaign paused"}),await D()}catch(s){p({type:"error",text:s.response?.data?.error||"Failed to pause campaign"})}},[D]),Y=e.useCallback(async(e,s)=>{try{const a=`${r.API_CAMPAIGNS}&id=${e}`;await i.post(a,{csv_list_id:s||null},{headers:{"Content-Type":"application/json"}}),N(a=>({...a,[e]:s})),await D(),await R(e),p({type:"success",text:"CSV list selection saved"})}catch(a){p({type:"error",text:a.response?.data?.message||a.response?.data?.error||"Failed to save CSV list selection"})}},[R,D]),O=e.useCallback(e=>{k(e),S(""),w(!0)},[]),Q=e.useCallback(e=>{_&&(Y(_,e),w(!1),k(null))},[_,Y]),X=e.useCallback(e=>{const s=y[e];return s?b.find(e=>e.id===parseInt(s)):null},[y,b]),Z=e.useCallback(async(e,s=0)=>{M(!0),E(!0),B(s);try{const a=await i.post(n,{action:"get_template_preview",campaign_id:e,email_index:s});a.data.success?L(a.data.data):(p({type:"error",text:a.data.message||"Failed to load template preview"}),E(!1))}catch(a){p({type:"error",text:"Failed to load template preview"}),E(!1)}finally{M(!1)}},[]),ee=e.useCallback((e,s)=>{Z(e,s)},[Z]),se=e.useCallback(()=>{E(!1),L(null),B(0),T("")},[]),ae=e.useCallback(e=>{const s=e.target.value;(""===s||/^\d+$/.test(s))&&T(s)},[]),te=e.useCallback(()=>{if(!I||!V)return;const e=parseInt(V),s=I.total_emails;if(e>=1&&e<=s){const s=e-1;ee(I.campaign_id,s),T("")}else p({type:"error",text:`Please enter a valid page number between 1 and ${s.toLocaleString()}`})},[I,V,ee]),le=e.useCallback(e=>{"Enter"===e.key&&te()},[te]);return e.useEffect(()=>{const e={};a.forEach(s=>{s.csv_list_id&&(e[s.campaign_id]=s.csv_list_id)}),N(e)},[a]),s.jsxs("div",{className:"bg-gray-100 min-h-screen mt-14",children:[c&&s.jsx("div",{className:"container mx-auto px-2 sm:px-4 py-6 w-full max-w-7xl",children:s.jsx("div",{className:"grid grid-cols-1 gap-4 sm:gap-6",children:s.jsx(l,{cards:3})})}),!c&&s.jsxs("div",{className:"container mx-auto px-2 sm:px-4 py-6 w-full max-w-7xl",children:[s.jsx(o,{message:x,onClose:()=>p(null)}),s.jsx("div",{className:"grid grid-cols-1 gap-4 sm:gap-6",children:H.map(e=>{const a=h[e.campaign_id]||{},t=X(e.campaign_id),l=e.import_batch_id||"imported_recipients"===e.email_source;let r;return r=void 0!==e.csv_list_valid_count&&null!==e.csv_list_valid_count?Number(e.csv_list_valid_count):Number(t?.valid_count?t.valid_count:e.valid_emails||0),s.jsx("div",{className:"bg-white rounded-xl shadow-md overflow-hidden transition-all hover:shadow-lg",children:s.jsxs("div",{className:"p-4 sm:p-6",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-gray-800 mb-1 break-words",children:e.description}),s.jsx("p",{className:"text-xs sm:text-sm text-gray-600 mb-2 break-words",children:e.mail_subject}),s.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-4",children:[s.jsxs("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full bg-green-100 text-green-800 text-xs sm:text-sm font-medium",children:[s.jsx("i",{className:"fas fa-envelope mr-1"}),r.toLocaleString()," Emails"]}),l&&s.jsxs(s.Fragment,{children:[s.jsxs("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full bg-purple-100 text-purple-800 text-xs sm:text-sm font-medium",children:[s.jsx("i",{className:"fas fa-file-excel mr-1"}),"Excel Import"]}),e.template_id&&s.jsxs("button",{onClick:()=>Z(e.campaign_id),className:"inline-flex items-center px-2.5 py-1 rounded-full bg-indigo-100 text-indigo-800 text-xs sm:text-sm font-medium hover:bg-indigo-200 transition-colors",children:[s.jsx("i",{className:"fas fa-eye mr-1"}),"Preview Template"]})]}),!l&&t&&s.jsxs("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full bg-blue-100 text-blue-800 text-xs sm:text-sm font-medium",children:[s.jsx("i",{className:"fas fa-list mr-1"}),t.list_name]}),!l&&e.csv_list_name&&!t&&s.jsxs("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full bg-blue-100 text-blue-800 text-xs sm:text-sm font-medium",children:[s.jsx("i",{className:"fas fa-list mr-1"}),e.csv_list_name]}),s.jsx(m,{status:e.campaign_status})]})]}),s.jsxs("div",{className:"flex flex-row flex-wrap gap-2 items-center mt-2 sm:mt-0",children:[s.jsx("button",{onClick:()=>q(e.campaign_id),className:"text-gray-500 hover:text-gray-700 px-2 py-1 rounded-lg",children:s.jsx("i",{className:`fas ${g[e.campaign_id]?"fa-chevron-up":"fa-chevron-down"} text-sm`})}),"running"===e.campaign_status?s.jsxs("button",{onClick:()=>K(e.campaign_id),className:"px-3 sm:px-4 py-2 bg-yellow-600 hover:bg-yellow-700 text-white rounded-lg text-xs sm:text-sm font-medium",children:[s.jsx("i",{className:"fas fa-pause mr-1"})," Pause"]}):"completed"===e.campaign_status?s.jsxs("span",{className:"px-3 sm:px-4 py-2 bg-gray-200 text-gray-600 rounded-lg text-xs sm:text-sm font-medium",children:[s.jsx("i",{className:"fas fa-check-circle mr-1"})," Completed"]}):s.jsxs(s.Fragment,{children:[l?s.jsx("div",{className:"px-3 py-2 border border-gray-300 rounded-lg text-xs bg-gray-50 min-w-[180px] text-left opacity-60 cursor-not-allowed",children:s.jsxs("div",{className:"flex items-center text-gray-500",children:[s.jsx("i",{className:"fas fa-lock mr-2"}),s.jsx("span",{children:"Using Imported Emails"})]})}):s.jsx("button",{onClick:()=>O(e.campaign_id),className:"px-3 py-2 border border-gray-300 rounded-lg text-xs bg-white hover:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors min-w-[180px] text-left",children:(()=>{const a=X(e.campaign_id);return a?s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"font-medium text-gray-900",children:a.list_name}),s.jsxs("span",{className:"text-xs text-gray-500",children:[e.csv_list_valid_count||a.valid_count||0," valid emails"]})]}):s.jsxs("span",{className:"text-gray-600",children:[s.jsx("i",{className:"fas fa-list mr-1"}),"Select CSV List"]})})()}),s.jsxs("button",{onClick:()=>J(e.campaign_id),className:"px-3 sm:px-4 py-2 bg-green-500 hover:bg-green-700 text-white rounded-lg text-xs sm:text-sm font-medium",children:[s.jsx("i",{className:"fas fa-paper-plane mr-1"})," Send"]})]})]})]}),g[e.campaign_id]&&s.jsx("div",{className:"mt-6",children:s.jsxs("div",{className:"space-y-3 mb-4",children:[s.jsxs("div",{className:"flex flex-wrap gap-4",children:[s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 flex flex-col items-center min-w-[120px]",children:[s.jsx("span",{className:"text-xs text-gray-500",children:"Pending"}),s.jsx("span",{className:"font-bold text-lg text-blue-700",children:void 0!==a.pending?a.pending:e.pending_emails||0})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 flex flex-col items-center min-w-[120px]",children:[s.jsx("span",{className:"text-xs text-gray-500",children:"Sent"}),s.jsx("span",{className:"font-bold text-lg text-green-700",children:void 0!==a.sent?a.sent:e.sent_emails||0})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 flex flex-col items-center min-w-[120px]",children:[s.jsx("span",{className:"text-xs text-gray-500",children:"Failed"}),s.jsx("span",{className:"font-bold text-lg text-red-700",children:void 0!==a.failed?a.failed:e.failed_emails||0})]}),(e.retryable_count>0||void 0!==a.retryable&&a.retryable>0)&&s.jsxs("div",{className:"bg-orange-50 rounded-lg p-3 flex flex-col items-center min-w-[120px]",children:[s.jsx("span",{className:"text-xs text-orange-600",children:"Retryable"}),s.jsx("span",{className:"font-bold text-lg text-orange-700",children:void 0!==a.retryable?a.retryable:e.retryable_count||0})]})]}),s.jsxs("div",{className:"mt-4 text-xs text-gray-500",children:["Started: ",e.start_time?e.start_time:"N/A",s.jsx("br",{}),"Ended: ",e.end_time?e.end_time:"N/A"]})]})})]})},e.campaign_id)})}),a.length>0&&s.jsxs("div",{className:"flex flex-col items-center justify-center mt-6 px-1 gap-2",children:[s.jsxs("div",{className:"text-xs sm:text-sm text-gray-500 mb-2",children:["Showing"," ",s.jsx("span",{className:"font-medium",children:($.page-1)*$.rowsPerPage+1})," ","to"," ",s.jsx("span",{className:"font-medium",children:Math.min($.page*$.rowsPerPage,$.total)})," ","of ",s.jsx("span",{className:"font-medium",children:$.total})," ","campaigns"]}),s.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[s.jsx("button",{onClick:()=>W(e=>({...e,page:1})),disabled:1===$.page,className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 transition-colors",children:s.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 19l-7-7 7-7m8 14l-7-7 7-7"})})}),s.jsx("button",{onClick:()=>W(e=>({...e,page:e.page-1})),disabled:1===$.page,className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 transition-colors",children:s.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})})}),s.jsxs("span",{className:"text-xs sm:text-sm font-medium text-gray-700",children:["Page ",$.page," of ",U]}),s.jsx("button",{onClick:()=>W(e=>({...e,page:Math.min(U,e.page+1)})),disabled:$.page>=U,className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 transition-colors",children:s.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})})}),s.jsx("button",{onClick:()=>W(e=>({...e,page:U})),disabled:$.page>=U,className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 transition-colors",children:s.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 5l7 7-7 7M5 5l7 7-7 7"})})}),s.jsx("select",{value:$.rowsPerPage,onChange:e=>W(s=>({...s,rowsPerPage:Number(e.target.value),page:1})),className:"border p-2 rounded-lg text-xs sm:text-sm bg-white focus:ring-blue-500 focus:border-blue-500 transition-colors",children:[10,25,50,100].map(e=>s.jsx("option",{value:e,children:e},e))})]})]})]}),v&&s.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-2 sm:p-4",children:s.jsxs("div",{className:"bg-white rounded-lg sm:rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] flex flex-col",children:[s.jsxs("div",{className:"px-3 sm:px-6 py-3 sm:py-4 border-b border-gray-200",children:[s.jsxs("div",{className:"flex justify-between items-center mb-3",children:[s.jsxs("h3",{className:"text-base sm:text-xl font-semibold text-gray-900 flex items-center",children:[s.jsx("i",{className:"fas fa-list-alt text-blue-600 mr-2 text-sm sm:text-base"}),s.jsx("span",{className:"hidden sm:inline",children:"Select CSV List for Campaign"}),s.jsx("span",{className:"sm:hidden",children:"Select CSV List"})]}),s.jsx("button",{onClick:()=>w(!1),className:"text-gray-400 hover:text-gray-500 p-2 rounded-lg hover:bg-gray-100 transition-colors",children:s.jsx("i",{className:"fas fa-times text-lg"})})]}),s.jsxs("div",{className:"relative",children:[s.jsx("i",{className:"fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Search CSV lists...",value:C,onChange:e=>S(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",autoFocus:!0})]})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto px-3 sm:px-6 py-3 sm:py-4",children:[s.jsx("button",{onClick:()=>Q(""),className:"w-full text-left px-3 sm:px-4 py-3 sm:py-4 rounded-lg border-2 mb-2 transition-all hover:border-blue-500 hover:bg-blue-50 touch-manipulation "+(y[_]?"border-gray-200 bg-white":"border-blue-500 bg-blue-50"),children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"font-semibold text-gray-900 flex items-center",children:[s.jsx("i",{className:"fas fa-globe mr-2 text-blue-600"}),"All Recipients"]}),s.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Send to all valid emails in the system"})]}),!y[_]&&s.jsx("i",{className:"fas fa-check-circle text-blue-600 text-xl"})]})}),b.filter(e=>e.list_name.toLowerCase().includes(C.toLowerCase())).map(e=>s.jsx("button",{onClick:()=>Q(e.id),className:"w-full text-left px-4 py-3 rounded-lg border-2 mb-2 transition-all hover:border-blue-500 hover:bg-blue-50 "+(y[_]===e.id.toString()?"border-blue-500 bg-blue-50":"border-gray-200 bg-white"),children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"font-semibold text-gray-900 flex items-center",children:[s.jsx("i",{className:"fas fa-file-csv mr-2 text-green-600"}),e.list_name]}),s.jsxs("div",{className:"text-sm text-gray-600 mt-1 flex items-center gap-4",children:[s.jsxs("span",{className:"flex items-center",children:[s.jsx("i",{className:"fas fa-check-circle text-green-600 mr-1"}),e.valid_count||0," valid emails"]}),s.jsxs("span",{className:"flex items-center text-gray-400",children:[s.jsx("i",{className:"fas fa-envelope mr-1"}),e.total_count||0," total"]})]})]}),y[_]===e.id.toString()&&s.jsx("i",{className:"fas fa-check-circle text-blue-600 text-xl"})]})},e.id)),C&&0===b.filter(e=>e.list_name.toLowerCase().includes(C.toLowerCase())).length&&s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx("i",{className:"fas fa-search text-4xl mb-2"}),s.jsxs("p",{children:['No CSV lists found matching "',C,'"']})]}),!C&&0===b.length&&s.jsxs("div",{className:"text-center py-12 text-gray-500",children:[s.jsx("div",{className:"mb-4",children:s.jsx("i",{className:"fas fa-inbox text-6xl text-gray-300"})}),s.jsx("h4",{className:"text-lg font-semibold text-gray-700 mb-2",children:"No CSV Lists Found"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Please check the Email Verification page to see your uploaded lists."})]})]}),s.jsx("div",{className:"px-3 sm:px-6 py-3 sm:py-4 border-t border-gray-200 bg-gray-50 rounded-b-xl",children:s.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-stretch sm:items-center gap-3",children:[s.jsxs("div",{className:"text-xs sm:text-sm text-gray-600 text-center sm:text-left order-2 sm:order-1",children:[s.jsx("i",{className:"fas fa-info-circle mr-1"}),b.length>0?`${b.length} CSV list${1!==b.length?"s":""} available`:"No CSV lists available"]}),s.jsxs("button",{onClick:()=>w(!1),className:"w-full sm:w-auto px-4 py-2.5 sm:py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors font-medium order-1 sm:order-2",children:[s.jsx("i",{className:"fas fa-times mr-2"}),"Close"]})]})})]})}),P&&s.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-start sm:items-center justify-center z-50 overflow-auto",children:s.jsxs("div",{className:"bg-white w-full sm:rounded-xl shadow-2xl sm:max-w-7xl sm:my-4 min-h-screen sm:min-h-0 sm:max-h-[95vh] flex flex-col",children:[s.jsxs("div",{className:"px-3 sm:px-6 py-3 sm:py-4 border-b border-gray-200 bg-gradient-to-r from-indigo-50 to-purple-50",children:[s.jsxs("div",{className:"flex justify-between items-start sm:items-center gap-2",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("h3",{className:"text-base sm:text-xl font-bold text-gray-900 flex items-center",children:[s.jsx("i",{className:"fas fa-envelope-open-text text-indigo-600 mr-2 sm:mr-3 text-sm sm:text-base"}),s.jsx("span",{className:"truncate",children:"Email Template Preview"})]}),I&&s.jsxs("p",{className:"text-xs sm:text-sm text-gray-600 mt-1 flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-3",children:[s.jsx("span",{className:"font-medium truncate",children:I.template_name}),s.jsx("span",{className:"text-gray-400 hidden sm:inline",children:"â€¢"}),s.jsx("span",{className:"truncate",children:I.campaign_name})]})]}),s.jsx("button",{onClick:se,className:"text-gray-400 hover:text-gray-600 p-1.5 sm:p-2 rounded-lg hover:bg-white transition-colors flex-shrink-0",children:s.jsx("i",{className:"fas fa-times text-lg sm:text-xl"})})]}),I&&I.has_sample_data&&s.jsx("div",{className:"mt-3 sm:mt-4 bg-white rounded-lg shadow-sm p-3 sm:p-4 border border-gray-200",children:s.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center justify-between gap-3 sm:gap-4",children:[s.jsxs("div",{className:"flex items-center justify-between sm:justify-start gap-2 sm:gap-3",children:[s.jsxs("button",{onClick:()=>ee(I.campaign_id,Math.max(0,A-1)),disabled:0===A||F,className:"px-3 sm:px-4 py-2 bg-indigo-600 text-white rounded-lg text-xs sm:text-sm font-medium hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all shadow-sm hover:shadow-md flex-1 sm:flex-initial",children:[s.jsx("i",{className:"fas fa-chevron-left sm:mr-2"}),s.jsx("span",{className:"hidden sm:inline",children:"Previous"})]}),s.jsx("div",{className:"px-3 sm:px-4 py-2 bg-gradient-to-r from-indigo-50 to-purple-50 rounded-lg border border-indigo-200",children:s.jsxs("span",{className:"text-xs sm:text-sm font-bold text-indigo-900 whitespace-nowrap",children:[s.jsx("span",{className:"hidden sm:inline",children:"Email "}),A+1," ",s.jsx("span",{className:"text-indigo-400 mx-1",children:"of"})," ",I.total_emails.toLocaleString()]})}),s.jsxs("button",{onClick:()=>ee(I.campaign_id,Math.min(I.total_emails-1,A+1)),disabled:A>=I.total_emails-1||F,className:"px-3 sm:px-4 py-2 bg-indigo-600 text-white rounded-lg text-xs sm:text-sm font-medium hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all shadow-sm hover:shadow-md flex-1 sm:flex-initial",children:[s.jsx("span",{className:"hidden sm:inline",children:"Next"}),s.jsx("i",{className:"fas fa-chevron-right sm:ml-2"})]})]}),s.jsxs("div",{className:"flex items-center gap-2 bg-gray-50 rounded-lg p-2 border border-gray-200",children:[s.jsxs("label",{htmlFor:"pageNumberInput",className:"text-xs sm:text-sm text-gray-700 font-medium whitespace-nowrap",children:[s.jsx("i",{className:"fas fa-hashtag text-indigo-600 mr-1"}),"Go to page:"]}),s.jsx("input",{id:"pageNumberInput",type:"text",inputMode:"numeric",pattern:"[0-9]*",value:V,onChange:ae,onKeyPress:le,placeholder:`1-${I.total_emails.toLocaleString()}`,disabled:F,className:"w-20 sm:w-24 px-2 py-1.5 border border-gray-300 rounded text-xs sm:text-sm text-center focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent disabled:opacity-50 disabled:cursor-not-allowed"}),s.jsxs("button",{onClick:te,disabled:!V||F,className:"px-3 py-1.5 bg-indigo-600 text-white rounded text-xs sm:text-sm font-medium hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all whitespace-nowrap",title:"Jump to page",children:[s.jsx("i",{className:"fas fa-arrow-right"}),s.jsx("span",{className:"hidden sm:inline ml-1",children:"Go"})]})]}),I.current_email&&s.jsx("div",{className:"mt-3 sm:mt-0 sm:flex-1 sm:ml-4 sm:pl-4 pt-3 sm:pt-0 border-t sm:border-t-0 sm:border-l-2 border-indigo-200",children:s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx("i",{className:"fas fa-user-circle text-indigo-600 text-lg sm:text-xl mt-0.5 flex-shrink-0"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"font-semibold text-gray-900 flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-2",children:[s.jsx("span",{className:"text-sm sm:text-base truncate",children:I.current_email.Emails||I.current_email.Email||I.current_email.email||I.current_email.raw_emailid||I.recipient_email||I.to||"Email not available"}),s.jsxs("span",{className:"px-2 py-0.5 bg-green-100 text-green-700 text-xs rounded-full font-medium inline-flex items-center self-start",children:[s.jsx("i",{className:"fas fa-check-circle mr-1"}),"Valid"]})]}),s.jsxs("div",{className:"text-xs text-gray-600 mt-1 flex flex-wrap items-center gap-2 sm:gap-3",children:[(I.current_email["Billed Name"]||I.current_email.BilledName||I.current_email.Name)&&s.jsxs("span",{className:"flex items-center",children:[s.jsx("i",{className:"fas fa-building text-gray-400 mr-1"}),I.current_email["Billed Name"]||I.current_email.BilledName||I.current_email.Name]}),I.current_email.Amount&&s.jsxs("span",{className:"flex items-center",children:[s.jsx("i",{className:"fas fa-rupee-sign text-gray-400 mr-1"}),I.current_email.Amount]}),I.current_email.Days&&s.jsxs("span",{className:"flex items-center",children:[s.jsx("i",{className:"fas fa-calendar-day text-gray-400 mr-1"}),I.current_email.Days," days"]}),(I.current_email["Bill Number"]||I.current_email.BillNumber)&&s.jsxs("span",{className:"flex items-center",children:[s.jsx("i",{className:"fas fa-file-invoice text-gray-400 mr-1"}),I.current_email["Bill Number"]||I.current_email.BillNumber]})]})]})]})})]})})]}),s.jsx("div",{className:"flex-1 overflow-hidden flex",children:F?s.jsx("div",{className:"flex-1 flex items-center justify-center bg-gray-50",children:s.jsxs("div",{className:"text-center",children:[s.jsx("i",{className:"fas fa-spinner fa-spin text-5xl text-indigo-600 mb-4"}),s.jsx("p",{className:"text-gray-600 font-medium",children:"Loading email preview..."}),s.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Merging template with recipient data"})]})}):I?s.jsxs("div",{className:"flex-1 overflow-y-auto bg-gray-100 p-3 sm:p-6",children:[!I.has_sample_data&&s.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 rounded-lg p-3 sm:p-4 mb-4 sm:mb-6 shadow-sm",children:s.jsxs("div",{className:"flex items-start",children:[s.jsx("i",{className:"fas fa-exclamation-triangle text-yellow-600 text-lg sm:text-xl mt-0.5 mr-2 sm:mr-3 flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-yellow-800",children:"No Sample Data Available"}),s.jsx("p",{className:"text-sm text-yellow-700 mt-1",children:"Showing template without merged data. Upload Excel data to see personalized preview with actual values."})]})]})}),s.jsxs("div",{className:"mx-auto w-full",style:{maxWidth:"800px"},children:[s.jsxs("div",{className:"bg-white rounded-t-lg sm:rounded-t-xl shadow-lg border border-gray-200 p-3 sm:p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2 sm:mb-3 pb-2 sm:pb-3 border-b border-gray-200",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"}),s.jsx("div",{className:"w-3 h-3 rounded-full bg-yellow-500"}),s.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"})]}),s.jsx("div",{className:"text-xs text-gray-500 font-medium",children:"Email Preview"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{className:"text-gray-400 hover:text-gray-600",children:s.jsx("i",{className:"fas fa-search text-sm"})}),s.jsx("button",{className:"text-gray-400 hover:text-gray-600",children:s.jsx("i",{className:"fas fa-ellipsis-v text-sm"})})]})]}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{className:"flex items-start",children:[s.jsx("span",{className:"text-gray-500 font-medium w-16",children:"From:"}),s.jsx("span",{className:"text-gray-900 flex-1",children:"Your Company <noreply@yourcompany.com>"})]}),I.current_email&&s.jsxs("div",{className:"flex items-start",children:[s.jsx("span",{className:"text-gray-500 font-medium w-16",children:"To:"}),s.jsx("span",{className:"text-gray-900 flex-1",children:I.current_email.Emails||I.current_email.Email||"recipient@example.com"})]}),s.jsxs("div",{className:"flex items-start",children:[s.jsx("span",{className:"text-gray-500 font-medium w-16",children:"Subject:"}),s.jsx("span",{className:"text-gray-900 flex-1 font-semibold",children:I.campaign_name})]})]})]}),s.jsx("div",{className:"bg-white shadow-lg border-x border-b border-gray-200 rounded-b-xl overflow-hidden",children:s.jsx("div",{className:"email-preview-body p-6",style:{minHeight:"400px",fontFamily:"system-ui, -apple-system, sans-serif"},dangerouslySetInnerHTML:{__html:I.template_html}})})]})]}):s.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500 bg-gray-50",children:s.jsxs("div",{className:"text-center",children:[s.jsx("i",{className:"fas fa-file-alt text-5xl mb-4 text-gray-300"}),s.jsx("p",{className:"text-lg font-medium",children:"No template data available"})]})})}),s.jsx("div",{className:"px-3 sm:px-6 py-3 sm:py-4 border-t border-gray-200 bg-gray-50",children:s.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-stretch sm:items-center gap-3",children:[s.jsx("div",{className:"text-xs sm:text-sm text-gray-600 flex items-center gap-2 order-2 sm:order-1",children:I&&I.has_sample_data&&s.jsxs(s.Fragment,{children:[s.jsx("i",{className:"fas fa-info-circle text-indigo-600 flex-shrink-0"}),s.jsxs("span",{className:"hidden md:inline",children:["Use ",s.jsx("kbd",{className:"px-2 py-1 bg-white border border-gray-300 rounded text-xs font-mono",children:"Previous"})," / ",s.jsx("kbd",{className:"px-2 py-1 bg-white border border-gray-300 rounded text-xs font-mono",children:"Next"})," or jump to specific page"]}),s.jsx("span",{className:"md:hidden",children:"Navigate with buttons or page number"})]})}),s.jsx("div",{className:"flex items-center gap-2 sm:gap-3 order-1 sm:order-2",children:s.jsxs("button",{onClick:se,className:"flex-1 sm:flex-initial px-4 sm:px-5 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg transition-colors font-medium shadow-sm hover:shadow-md text-sm",children:[s.jsx("i",{className:"fas fa-times mr-2"}),"Close Preview"]})})]})})]})})]})},m=a.memo(({status:e})=>{const a=(e||"pending").toLowerCase(),t=e||"Pending";return s.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold text-white ${{pending:"bg-yellow-500",running:"bg-blue-500",paused:"bg-gray-500",completed:"bg-green-500",failed:"bg-red-500"}[a]||"bg-yellow-500"}`,children:t})}),o=a.memo(({message:e,onClose:a})=>e?s.jsxs("div",{className:"fixed top-6 left-1/2 transform -translate-x-1/2\n      px-6 py-3 rounded-xl shadow-lg text-base font-bold\n      flex items-center gap-3\n      "+("error"===e.type?"bg-red-50 border-2 border-red-500 text-red-700":"bg-green-50 border-2 border-green-500 text-green-700"),style:{minWidth:250,maxWidth:600,zIndex:99999,boxShadow:"error"===e.type?"0 8px 32px 0 rgba(220, 38, 38, 0.4)":"0 8px 32px 0 rgba(34, 197, 94, 0.4)",background:"error"===e.type?"rgba(254, 226, 226, 0.95)":"rgba(220, 252, 231, 0.95)",borderRadius:"16px",backdropFilter:"blur(8px)",WebkitBackdropFilter:"blur(8px)"},role:"alert",children:[s.jsx("i",{className:"fas text-xl "+("error"===e.type?"fa-exclamation-circle text-red-600":"fa-check-circle text-green-600")}),s.jsx("span",{className:"flex-1",children:e.text}),s.jsx("button",{onClick:a,className:"ml-2 text-gray-500 hover:text-gray-700 focus:outline-none","aria-label":"Close",children:s.jsx("i",{className:"fas fa-times"})})]}):null);m.displayName="StatusBadge",o.displayName="StatusMessage";export{c as default};
