import{a as e,j as t,R as s}from"./react-core-Bz_OFM-J.js";import{Q as a}from"./editor-t5Pr0pkD.js";import{A as l}from"./index-2wpkHUii.js";import"./react-dom-oZ-VTmTY.js";import"./vendor-ZyZh7GQr.js";import"./react-router-Cm8bNIlG.js";const r={toolbar:[[{header:[1,2,3,!1]}],["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],[{color:[]},{background:[]}],["link","image"],["clean"]]},i=["header","bold","italic","underline","strike","list","bullet","link","color","background","image"];function n(t){const s=e.useRef(t);return e.useEffect(()=>{s.current=t},[t]),s}const o="<p><br></p>";function c({value:s,onChange:l,modules:c,formats:d,placeholder:m,onImageUpload:x,uploadImageUrl:u,minHeight:p=200}){const g=e.useRef(null),h=e.useRef(null),b=e.useRef(null),[f,y]=e.useState(!1),j=n(l),N=n(x),v=e.useMemo(()=>c??r,[c]),w=e.useMemo(()=>d??i,[d]);return e.useEffect(()=>{if(!g.current||h.current)return;const e=g.current,t=e.parentElement?.querySelector(":scope > .ql-toolbar");t?.remove();const s=new a(e,{theme:"snow",modules:v,formats:w,placeholder:m});h.current=s,y(!0);const l=s.getModule("toolbar");l&&"container"in l&&(b.current=l.container,l.addHandler("image",async()=>{const e=document.createElement("input");e.type="file",e.accept="image/*",e.click(),e.onchange=async()=>{const t=e.files?.[0];if(!t)return;const a=s.getSelection(!0),l=a?.index??s.getLength();s.insertText(l,"Uploading image…");const r=new FormData;r.append("image",t);try{const e=await fetch(u,{method:"POST",body:r}),t=await e.json();s.deleteText(l,16),t.success?(s.insertEmbed(l,"image",t.url),s.setSelection({index:l+1,length:0}),N.current?.(t.path)):alert(`✗ Upload failed: ${t.message??"unknown error"}`)}catch(i){s.deleteText(l,16),i instanceof Error&&alert(`✗ Upload error: ${i.message}`)}}}));const r=()=>{if(!h.current)return;const e=h.current.root.innerHTML;j.current(e===o?"":e)};return s.on("text-change",r),()=>{s.off("text-change",r),b.current?.remove(),b.current=null,h.current=null,e.innerHTML="",y(!1)}},[w,v,m,u,j,N]),e.useEffect(()=>{if(!f||!h.current)return;const e=h.current,t=e.root.innerHTML,a=s||"";if(t===a||t===o&&""===a)return;const l=e.getSelection(),r=l?.index??e.getLength();e.setContents(e.clipboard.convert(a)),e.setSelection({index:Math.min(r,e.getLength()),length:0})},[f,s]),t.jsx("div",{className:"quill-editor-wrapper bg-white rounded-lg border border-gray-300",children:t.jsx("div",{ref:g,style:{minHeight:p}})})}const d={description:"",mail_subject:"",mail_body:"",attachment:null,existing_attachment:null,images:[]},m=({message:e,onClose:s})=>e&&t.jsxs("div",{className:`\n        fixed top-6 left-1/2 transform -translate-x-1/2 z-50\n        px-6 py-3 rounded-xl shadow text-base font-semibold\n        flex items-center gap-3\n        transition-all duration-300\n        backdrop-blur-md\n        ${"error"===e.type?"bg-red-200/60 border border-red-400 text-red-800":"bg-green-200/60 border border-green-400 text-green-800"}\n      `,style:{minWidth:250,maxWidth:400,boxShadow:"0 8px 32px 0 rgba(0, 0, 0, 0.23)",background:"error"===e.type?"rgba(255, 0, 0, 0.29)":"rgba(0, 200, 83, 0.29)",borderRadius:"16px",backdropFilter:"blur(8px)",WebkitBackdropFilter:"blur(8px)"},role:"alert",children:[t.jsx("i",{className:"fas text-lg "+("error"===e.type?"fa-exclamation-circle text-red-500":"fa-check-circle text-green-500")}),t.jsx("span",{className:"flex-1",children:e.text}),t.jsx("button",{onClick:s,className:"ml-2 text-gray-500 hover:text-gray-700 focus:outline-none","aria-label":"Close",children:t.jsx("i",{className:"fas fa-times"})})]}),x=()=>{const[a,r]=e.useState([]),[i,n]=e.useState(!0),[o,x]=e.useState(!1),[u,p]=e.useState(!1),[g,h]=e.useState(d),[b,f]=e.useState(null),[y,j]=e.useState([]),[N,v]=e.useState(null),[w,k]=e.useState(null),[_,C]=e.useState({page:1,rowsPerPage:10,total:0}),S=l.BASE_URL,E=l.API_MASTER_CAMPAIGNS,P=l.UPLOAD_IMAGE,M=s.useCallback(async()=>{n(!0);try{const e=await fetch(E,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"list"})}),t=await e.json(),s=t?.data?.campaigns||[];Array.isArray(s)?(r(s),C(e=>({...e,total:s.length}))):(r([]),C(e=>({...e,total:0})))}catch(e){k({type:"error",text:"Failed to load campaigns."}),r([]),C(e=>({...e,total:0}))}n(!1)},[E]);e.useEffect(()=>{M()},[M]);const $=e=>{const{name:t,value:s,files:a}=e.target;"attachment"===t?f(a[0]):h(e=>({...e,[t]:s}))},A=e=>{const t=L(e);j(e=>[...e,t])},L=e=>{if(!e)return e;let t=e.replace(/^https?:\/\/[^/]+/i,"");return t=t.replace(/^\/verify_emails\/MailPilot_CRM\/backend\//i,""),t=t.replace(/^\/backend\//i,""),t=t.replace(/^backend\//i,""),t.includes("storage/")&&!t.startsWith("storage/")&&(t=t.substring(t.indexOf("storage/"))),t=t.replace(/^\/+/,""),t},T=e=>{if(!e)return e;let t=e;return t=t.replace(/http:\/\/localhost\/verify_emails\/MailPilot_CRM\/backend\/(storage\/[^"'\s>]+)/gi,"$1"),t=t.replace(/\/verify_emails\/MailPilot_CRM\/backend\/(storage\/[^"'\s>]+)/gi,"$1"),t=t.replace(/\/backend\/(storage\/[^"'\s>]+)/gi,"$1"),t},O=e=>{if(!e)return[];const t=[],s=document.createElement("div");return s.innerHTML=e,s.querySelectorAll("img").forEach(e=>{let s=e.getAttribute("src");if(s&&s.includes("storage/images/")){const e=L(s);e&&!t.includes(e)&&t.push(e)}}),t},D=e=>e?e.replace(/src=(["'])(storage\/images\/[^"']+)\1/gi,(e,t,s)=>`src=${t}${S}/backend/${s}${t}`):e,U=e=>{v(e.campaign_id);const t=e.images_paths?JSON.parse(e.images_paths):[];let s=D(e.mail_body||"");t.forEach(e=>{const t=`${S}/backend/${e}`;-1===s.indexOf(t)&&-1===s.indexOf(e)&&(s+=`<p><img src='${t}' style='max-width:300px;'/></p>`)}),h({description:e.description,mail_subject:e.mail_subject,mail_body:s,attachment:null,existing_attachment:e.attachment_path||null,images:t}),f(null),j([]),p(!0)},R=async e=>{r(t=>t.filter(t=>t.campaign_id!==e)),C(e=>({...e,total:e.total-1}));try{const t=await fetch(`${E}?id=${e}`,{method:"DELETE"}),s=await t.json();s.success?k({type:"success",text:"Campaign deleted successfully!"}):(k({type:"error",text:s.message||"Failed to delete campaign."}),M())}catch{k({type:"error",text:"Failed to delete campaign."}),M()}},F=async e=>{try{const t=await fetch(`${E}?id=${e}`),s=await t.json(),a=s.images_paths?JSON.parse(s.images_paths):[];let l=D(s.mail_body||"");a.forEach(e=>{const t=`${S}/backend/${e}`;-1===l.indexOf(t)&&-1===l.indexOf(e)&&(l+=`<p><img src='${t}' style='max-width:300px;'/></p>`)}),h({description:s.description,mail_subject:s.mail_subject,mail_body:l,attachment:null,existing_attachment:s.attachment_path||null,images:a}),v(null),f(null),j([]),x(!0)}catch{k({type:"error",text:"Failed to load campaign for reuse."})}};e.useEffect(()=>{if(w){const e=setTimeout(()=>k(null),3e3);return()=>clearTimeout(e)}},[w]);const I=e=>{if(!e)return"";const t=document.createElement("div");t.innerHTML=e;const s=(t.textContent||t.innerText||"").trim().split(/\s+/).filter(e=>e.length>0);return s.slice(0,30).join(" ")+(s.length>30?"...":"")},W=Math.max(1,Math.ceil(_.total/_.rowsPerPage)),B=a.slice((_.page-1)*_.rowsPerPage,_.page*_.rowsPerPage);return t.jsxs("div",{className:"container mx-auto mt-12 px-2 sm:px-4 py-8 max-w-7xl",children:[t.jsx(m,{message:w,onClose:()=>k(null)}),t.jsxs("div",{className:"flex justify-between items-center mb-6",children:[t.jsxs("h1",{className:"text-2xl font-bold text-gray-800",children:[t.jsx("i",{className:"fas fa-bullhorn mr-2 text-blue-600"}),"Email Campaigns"]}),t.jsxs("button",{onClick:()=>{h(d),x(!0)},className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md flex items-center",children:[t.jsx("i",{className:"fas fa-plus mr-2"})," Add Campaign"]})]}),t.jsx("div",{className:"block sm:hidden",children:B.map(e=>t.jsxs("div",{className:"bg-white rounded-2xl shadow p-4 mb-4 flex flex-col",children:[t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsxs("div",{className:"text-lg font-bold text-gray-900 mb-1",children:["ID: ",e.campaign_id]}),t.jsx("div",{className:"font-semibold text-gray-900",children:"Description:"}),t.jsx("div",{className:"text-gray-600 text-base mb-2 break-words",children:e.description})]}),t.jsxs("div",{className:"flex flex-col gap-2 items-end ml-2",children:[t.jsx("button",{onClick:()=>U(e),className:"text-blue-600 hover:text-blue-800 p-1 rounded",title:"Edit",children:t.jsx("i",{className:"fas fa-edit text-xl"})}),t.jsx("button",{onClick:()=>F(e.campaign_id),className:"text-green-600 hover:text-green-800 p-1 rounded",title:"Reuse",children:t.jsx("i",{className:"fas fa-copy text-xl"})}),t.jsx("button",{onClick:()=>{window.confirm("Are you sure you want to delete this campaign?")&&R(e.campaign_id)},className:"text-red-600 hover:text-red-800 p-1 rounded",title:"Delete",children:t.jsx("i",{className:"fas fa-trash text-xl"})})]})]}),t.jsxs("div",{className:"mt-2",children:[t.jsx("div",{className:"font-semibold text-gray-900 text-xs uppercase tracking-wide mb-1",children:"Subject:"}),t.jsx("div",{className:"text-gray-700 text-sm break-words mb-3",children:e.mail_subject}),t.jsx("div",{className:"font-semibold text-gray-900 text-xs uppercase tracking-wide mb-1",children:"Email Preview:"}),t.jsx("div",{className:"text-gray-600 text-sm leading-relaxed",style:{display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",overflow:"hidden"},children:I(e.mail_body)}),e.attachment_path&&t.jsx("div",{className:"mt-2 flex items-center gap-2",children:t.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[t.jsx("i",{className:"fas fa-paperclip mr-1"}),"Has Attachment"]})})]})]},e.campaign_id))}),t.jsx("div",{className:"hidden sm:block bg-white rounded-lg shadow overflow-hidden",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"w-16 px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ID"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subject"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email Preview"}),t.jsx("th",{className:"w-40 px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:i?t.jsx("tr",{children:t.jsx("td",{colSpan:5,className:"px-6 py-4 text-center text-sm text-gray-500",children:"Loading..."})}):0===a.length?t.jsx("tr",{children:t.jsx("td",{colSpan:5,className:"px-6 py-4 text-center text-sm text-gray-500",children:"No campaigns found. Add one to get started."})}):B.map(e=>t.jsxs("tr",{className:"hover:bg-gray-50 transition-colors duration-150",children:[t.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-500",children:e.campaign_id}),t.jsx("td",{className:"px-4 py-3",children:t.jsx("div",{className:"text-sm font-medium text-gray-900 truncate max-w-xs",children:e.description})}),t.jsx("td",{className:"px-4 py-3",children:t.jsx("div",{className:"text-sm text-gray-900 truncate max-w-xs",children:e.mail_subject})}),t.jsxs("td",{className:"px-4 py-3",children:[t.jsx("div",{className:"text-sm text-gray-600 max-w-xs line-clamp-2",title:I(e.mail_body),style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis"},children:I(e.mail_body)}),e.attachment_path&&t.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 mt-1 rounded text-xs font-medium bg-blue-100 text-blue-800",children:[t.jsx("i",{className:"fas fa-paperclip mr-1"}),"Attachment"]})]}),t.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-right text-sm font-medium",children:t.jsxs("div",{className:"flex justify-end space-x-2",children:[t.jsx("button",{onClick:()=>U(e),className:"text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-50",title:"Edit",children:t.jsx("i",{className:"fas fa-edit"})}),t.jsx("button",{onClick:()=>F(e.campaign_id),className:"text-green-600 hover:text-green-800 p-1 rounded hover:bg-green-50",title:"Reuse",children:t.jsx("i",{className:"fas fa-copy"})}),t.jsx("button",{onClick:()=>{window.confirm("Are you sure you want to delete this campaign?")&&R(e.campaign_id)},className:"text-red-600 hover:text-red-800 p-1 rounded hover:bg-red-50",title:"Delete",children:t.jsx("i",{className:"fas fa-trash"})})]})})]},e.campaign_id))})]})})}),a.length>0&&t.jsxs("div",{className:"flex flex-col items-center justify-center mt-6 px-1 gap-2",children:[t.jsxs("div",{className:"text-xs sm:text-sm text-gray-500 mb-2",children:["Showing"," ",t.jsx("span",{className:"font-medium",children:(_.page-1)*_.rowsPerPage+1})," ","to"," ",t.jsx("span",{className:"font-medium",children:Math.min(_.page*_.rowsPerPage,_.total)})," ","of ",t.jsx("span",{className:"font-medium",children:_.total})," ","campaigns"]}),t.jsxs("div",{className:"flex flex-wrap items-center gap-2 pb-5",children:[t.jsx("button",{onClick:()=>C(e=>({...e,page:1})),disabled:1===_.page,className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 transition-colors",children:t.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 19l-7-7 7-7m8 14l-7-7 7-7"})})}),t.jsx("button",{onClick:()=>C(e=>({...e,page:e.page-1})),disabled:1===_.page,className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 transition-colors",children:t.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})})}),t.jsxs("span",{className:"text-xs sm:text-sm font-medium text-gray-700",children:["Page ",_.page," of ",W]}),t.jsx("button",{onClick:()=>C(e=>({...e,page:Math.min(W,e.page+1)})),disabled:_.page>=W,className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 transition-colors",children:t.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})})}),t.jsx("button",{onClick:()=>C(e=>({...e,page:W})),disabled:_.page>=W,className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 transition-colors",children:t.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 5l7 7-7 7M5 5l7 7-7 7"})})}),t.jsx("select",{value:_.rowsPerPage,onChange:e=>C(t=>({...t,rowsPerPage:Number(e.target.value),page:1})),className:"border p-2 rounded-lg text-xs sm:text-sm bg-white focus:ring-blue-500 focus:border-blue-500 transition-colors",children:[10,25,50,100].map(e=>t.jsx("option",{value:e,children:e},e))})]})]}),o&&t.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm overflow-y-auto h-full w-full z-50",children:t.jsxs("div",{className:"min-h-screen px-4 text-center",children:[t.jsx("span",{className:"inline-block h-screen align-middle","aria-hidden":"true",children:"​"}),t.jsxs("div",{className:"inline-block w-11/12 md:w-3/4 lg:w-2/3 max-w-5xl my-8 text-left align-middle transition-all transform bg-white shadow-2xl rounded-xl",children:[t.jsx("div",{className:"sticky top-0 z-10 bg-white px-6 py-4 border-b border-gray-200 rounded-t-xl",children:t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("h3",{className:"text-xl font-semibold text-gray-900 flex items-center gap-2",children:[t.jsx("i",{className:"fas fa-plus-circle text-blue-600"}),"Add New Campaign"]}),t.jsx("button",{onClick:()=>x(!1),className:"text-gray-400 hover:text-gray-500 p-2 rounded-lg hover:bg-gray-100 transition-colors","aria-label":"Close",children:t.jsx("i",{className:"fas fa-times text-lg"})})]})}),t.jsxs("form",{onSubmit:async e=>{e.preventDefault();const t=T(g.mail_body),s=O(t),a=new FormData;a.append("description",g.description),a.append("mail_subject",g.mail_subject),a.append("mail_body",t),a.append("send_as_html","1"),b&&a.append("attachment",b),a.append("images_json",JSON.stringify(s));try{const e=await fetch(E,{method:"POST",body:a}),t=await e.json();t.success?(k({type:"success",text:"Campaign added successfully!"}),x(!1),h(d),f(null),j([]),M()):k({type:"error",text:t.message||"Failed to add campaign."})}catch{k({type:"error",text:"Failed to add campaign."})}},encType:"multipart/form-data",className:"px-6 py-4",children:[t.jsx("div",{className:"space-y-6",children:t.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Description"}),t.jsx("input",{type:"text",name:"description",required:!0,className:"block w-full px-4 py-3 bg-gray-50 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500 transition-colors sm:text-sm",placeholder:"Enter campaign description",value:g.description,onChange:$})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Email Subject"}),t.jsx("input",{type:"text",name:"mail_subject",required:!0,className:"block w-full px-4 py-3 bg-gray-50 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500 transition-colors sm:text-sm",placeholder:"Enter email subject line",value:g.mail_subject,onChange:$})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Email Body"}),t.jsx("div",{className:"bg-white border border-gray-300 rounded-lg overflow-hidden shadow-sm",style:{zIndex:1001},children:t.jsx(c,{value:g.mail_body,onChange:e=>h(t=>({...t,mail_body:e})),onImageUpload:A,uploadImageUrl:P,placeholder:"Compose your email content here..."})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Attachment (Optional)"}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsxs("label",{className:"flex-1",children:[t.jsx("span",{className:"sr-only",children:"Choose file"}),t.jsx("input",{type:"file",name:"attachment",onChange:$,accept:".pdf,.jpg,.jpeg,.png,.doc,.docx,.xls,.xlsx,.csv,.txt",id:"attachment-input",className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 focus:outline-none"})]}),b&&t.jsx("button",{type:"button",onClick:()=>f(null),className:"p-2 text-gray-400 hover:text-gray-500",title:"Remove attachment",children:t.jsx("i",{className:"fas fa-times"})})]}),b&&t.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:[t.jsx("i",{className:"fas fa-paperclip mr-2"}),b.name]})]})]})}),t.jsxs("div",{className:"mt-6 border-t border-gray-200 pt-6 flex items-center justify-end gap-3",children:[t.jsx("button",{type:"button",onClick:()=>x(!1),className:"px-4 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",children:"Cancel"}),t.jsxs("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors inline-flex items-center",children:[t.jsx("i",{className:"fas fa-save mr-2"}),"Save Campaign"]})]})]})]})]})}),u&&t.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm overflow-y-auto h-full w-full z-50",children:t.jsxs("div",{className:"min-h-screen px-4 text-center",children:[t.jsx("span",{className:"inline-block h-screen align-middle","aria-hidden":"true",children:"​"}),t.jsxs("div",{className:"inline-block w-11/12 md:w-3/4 lg:w-2/3 max-w-5xl my-8 text-left align-middle transition-all transform bg-white shadow-2xl rounded-xl",children:[t.jsx("div",{className:"sticky top-0 z-10 bg-white px-6 py-4 border-b border-gray-200 rounded-t-xl",children:t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("h3",{className:"text-xl font-semibold text-gray-900 flex items-center gap-2",children:[t.jsx("i",{className:"fas fa-edit text-blue-600"}),"Edit Campaign"]}),t.jsx("button",{onClick:()=>p(!1),className:"text-gray-400 hover:text-gray-500 p-2 rounded-lg hover:bg-gray-100 transition-colors","aria-label":"Close",children:t.jsx("i",{className:"fas fa-times text-lg"})})]})}),t.jsxs("form",{onSubmit:async e=>{e.preventDefault();const t=T(g.mail_body),s=new FormData;s.append("description",g.description),s.append("mail_subject",g.mail_subject),s.append("mail_body",t),s.append("send_as_html","1"),b&&s.append("attachment",b);const a=O(t);s.append("images_json",JSON.stringify(a)),s.append("_method","PUT");try{const e=await fetch(`${E}?id=${N}`,{method:"POST",body:s}),t=await e.json();t.success?(k({type:"success",text:"Campaign updated successfully!"}),p(!1),h(d),f(null),j([]),M()):k({type:"error",text:t.message||"Failed to update campaign."})}catch{k({type:"error",text:"Failed to update campaign."})}},encType:"multipart/form-data",className:"px-6 py-4",children:[t.jsx("div",{className:"space-y-6",children:t.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Description"}),t.jsx("input",{type:"text",name:"description",required:!0,className:"block w-full px-4 py-3 bg-gray-50 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500 transition-colors sm:text-sm",value:g.description,onChange:$})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Email Subject"}),t.jsx("input",{type:"text",name:"mail_subject",required:!0,className:"block w-full px-4 py-3 bg-gray-50 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500 transition-colors sm:text-sm",value:g.mail_subject,onChange:$})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Email Body (Use image button in toolbar to add images)"}),t.jsx("div",{className:"bg-white border border-gray-300 rounded-lg overflow-hidden shadow-sm",style:{zIndex:1001},children:t.jsx(c,{value:g.mail_body,onChange:e=>h(t=>({...t,mail_body:e})),onImageUpload:A,uploadImageUrl:P,placeholder:"Update your email content here..."})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Attachment (Optional)"}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsxs("label",{className:"flex-1",children:[t.jsx("span",{className:"sr-only",children:"Choose file"}),t.jsx("input",{type:"file",name:"attachment",onChange:$,accept:".pdf,.jpg,.jpeg,.png,.doc,.docx,.xls,.xlsx,.csv,.txt",id:"edit-attachment-input",className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 focus:outline-none"})]}),b&&t.jsx("button",{type:"button",onClick:()=>f(null),className:"p-2 text-gray-400 hover:text-gray-500",title:"Remove attachment",children:t.jsx("i",{className:"fas fa-times"})})]}),b&&t.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:[t.jsx("i",{className:"fas fa-paperclip mr-2"}),b.name]}),!b&&g.existing_attachment&&t.jsxs("div",{className:"mt-2 text-sm text-gray-600 border-t pt-2",children:[t.jsx("p",{className:"font-medium text-gray-700 mb-1",children:"Existing attachment:"}),t.jsxs("div",{className:"flex items-center justify-between bg-gray-50 rounded px-3 py-2",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx("i",{className:"fas fa-file mr-2 text-blue-600"}),t.jsx("span",{className:"text-xs",children:g.existing_attachment.split("/").pop()})]}),t.jsxs("a",{href:`${S}/backend/${g.existing_attachment}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 text-xs",children:[t.jsx("i",{className:"fas fa-download"})," Download"]})]}),t.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[t.jsx("i",{className:"fas fa-info-circle mr-1"}),"Upload a new file to replace this attachment"]})]})]})]})}),t.jsxs("div",{className:"mt-6 border-t border-gray-200 pt-6 flex items-center justify-end gap-3",children:[t.jsx("button",{type:"button",onClick:()=>p(!1),className:"px-4 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",children:"Cancel"}),t.jsxs("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors inline-flex items-center",children:[t.jsx("i",{className:"fas fa-save mr-2"}),"Update Campaign"]})]})]})]})]})})]})};export{x as default};
