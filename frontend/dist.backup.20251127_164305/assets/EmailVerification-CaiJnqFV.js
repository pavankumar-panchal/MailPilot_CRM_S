import{a as e,j as t}from"./react-core-Bz_OFM-J.js";import{A as s}from"./index-2wpkHUii.js";import"./editor-t5Pr0pkD.js";import"./react-dom-oZ-VTmTY.js";import"./vendor-ZyZh7GQr.js";import"./react-router-Cm8bNIlG.js";const a=({listId:a,onClose:r})=>{const[l,i]=e.useState([]),[n,o]=e.useState(null),[d,c]=e.useState(!1),[x,m]=e.useState({page:1,rowsPerPage:10,total:0}),[p,g]=e.useState("all"),u=e.useCallback(async()=>{try{c(!0);const e=await fetch(`${s.API_RESULTS}?csv_list_id=${a}&limit=1000000`),t=await e.json();i(Array.isArray(t.data)?t.data:[]),m(e=>({...e,total:Array.isArray(t.data)?t.data.length:0}))}catch{i([]),o({type:"error",message:"Failed to load list emails"})}finally{c(!1)}},[a]),h=e=>(e.validation_response||"").toLowerCase().includes("timeout")||(e.validation_response||"").toLowerCase().includes("connection refused")||(e.validation_response||"").toLowerCase().includes("failed to connect"),f=l.filter(e=>"all"===p||("valid"===p?1===e.domain_status:"invalid"===p?0===e.domain_status&&!h(e):"timeout"!==p||h(e))),b=f.slice((x.page-1)*x.rowsPerPage,x.page*x.rowsPerPage);e.useEffect(()=>{u()},[u]),e.useEffect(()=>{m(e=>({...e,page:1,total:f.length}))},[p,x.rowsPerPage,f.length]);const y=({status:e,onClose:s})=>e&&t.jsxs("div",{className:`\n          fixed top-6 left-1/2 transform -translate-x-1/2 z-50\n          px-6 py-3 rounded-xl shadow text-base font-semibold\n          flex items-center gap-3\n          transition-all duration-300\n          backdrop-blur-md\n          ${"error"===e.type?"bg-red-200/60 border border-red-400 text-red-800":"bg-green-200/60 border border-green-400 text-green-800"}\n        `,style:{minWidth:250,maxWidth:400,boxShadow:"0 8px 32px 0 rgba(0, 0, 0, 0.23)",background:"error"===e.type?"rgba(255, 0, 0, 0.29)":"rgba(0, 200, 83, 0.29)",borderRadius:"16px",backdropFilter:"blur(8px)",WebkitBackdropFilter:"blur(8px)"},role:"alert",children:[t.jsx("i",{className:"fas text-lg "+("error"===e.type?"fa-exclamation-circle text-red-500":"fa-check-circle text-green-500")}),t.jsx("span",{className:"flex-1",children:e.message}),t.jsx("button",{onClick:s,className:"ml-2 text-gray-500 hover:text-gray-700 focus:outline-none","aria-label":"Close",children:t.jsx("i",{className:"fas fa-times"})})]});e.useEffect(()=>{if(n){const e=setTimeout(()=>o(null),4e3);return()=>clearTimeout(e)}},[n]);const j=e=>{let t=[];if(t="valid"===e?l.filter(e=>1===e.domain_status):"invalid"===e?l.filter(e=>0===e.domain_status&&!h(e)):"timeout"===e?l.filter(h):l,0===t.length)return void o({type:"error",message:"No emails found for export."});const s=["EMAILS",...t.map(e=>`"${e.email.replace(/"/g,'""')}"`)].join("\n"),a=new Blob([s],{type:"text/csv"}),r=URL.createObjectURL(a),i=document.createElement("a");i.href=r,i.download=`${e}_emails.csv`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(r),o({type:"success",message:"Exported successfully."})},v=e=>"valid"===e?l.filter(e=>1===e.domain_status).length:"invalid"===e?l.filter(e=>0===e.domain_status&&!h(e)).length:"timeout"===e?l.filter(h).length:l.length;return t.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/30 backdrop-blur-md backdrop-saturate-150 p-4",children:t.jsxs("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-6xl max-h-[90vh] flex flex-col",onClick:e=>e.stopPropagation(),children:[t.jsxs("div",{className:"p-6 pb-0 flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Email List Details"}),t.jsxs("p",{className:"text-gray-600",children:["List ID: ",a]})]}),t.jsx("button",{className:"text-gray-500 hover:text-gray-700 p-2 rounded-full hover:bg-gray-100",onClick:r,"aria-label":"Close",children:t.jsx("i",{className:"fas fa-times text-xl"})})]}),t.jsx(y,{status:n,onClose:()=>o(null)}),t.jsx("div",{className:"p-6 pt-4 border-b border-gray-200",children:t.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4 mb-4",children:[t.jsxs("div",{className:"flex flex-wrap gap-2",children:[t.jsxs("button",{onClick:()=>g("all"),className:"px-4 py-2 rounded-lg font-medium text-sm "+("all"===p?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:["All (",v("all"),")"]}),t.jsxs("button",{onClick:()=>g("valid"),className:"px-4 py-2 rounded-lg font-medium text-sm "+("valid"===p?"bg-green-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:["Valid (",v("valid"),")"]}),t.jsxs("button",{onClick:()=>g("invalid"),className:"px-4 py-2 rounded-lg font-medium text-sm "+("invalid"===p?"bg-red-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:["Invalid (",v("invalid"),")"]}),t.jsxs("button",{onClick:()=>g("timeout"),className:"px-4 py-2 rounded-lg font-medium text-sm "+("timeout"===p?"bg-yellow-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:["Timeout (",v("timeout"),")"]})]}),t.jsxs("div",{className:"flex flex-wrap gap-2",children:[t.jsxs("button",{onClick:()=>j("valid"),className:"px-4 py-2 bg-green-600 text-white rounded-lg font-medium text-sm hover:bg-green-700 flex items-center gap-2",children:[t.jsx("i",{className:"fas fa-file-export"}),"Export Valid"]}),t.jsxs("button",{onClick:()=>j("invalid"),className:"px-4 py-2 bg-red-600 text-white rounded-lg font-medium text-sm hover:bg-red-700 flex items-center gap-2",children:[t.jsx("i",{className:"fas fa-file-export"}),"Export Invalid"]}),t.jsxs("button",{onClick:()=>j("timeout"),className:"px-4 py-2 bg-yellow-600 text-white rounded-lg font-medium text-sm hover:bg-yellow-700 flex items-center gap-2",children:[t.jsx("i",{className:"fas fa-file-export"}),"Export Timeout"]})]})]})}),t.jsx("div",{className:"overflow-auto flex-1",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50 sticky top-0",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ID"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Account"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Domain"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Verified"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Response"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:d?Array.from({length:x.rowsPerPage}).map((e,s)=>t.jsx("tr",{className:"animate-pulse",children:Array.from({length:7}).map((e,s)=>t.jsx("td",{className:"px-6 py-4",children:t.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mx-auto"})},s))},s)):0===b.length?t.jsx("tr",{children:t.jsx("td",{colSpan:7,className:"px-6 py-8 text-center text-gray-500",children:"No emails found matching the current filter"})}):b.map(e=>t.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.id}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.raw_emailid||e.email||"N/A"}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.sp_account}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.sp_domain}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full "+(1==e.domain_verified?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:1==e.domain_verified?"Verified":"Invalid"})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full "+(h(e)?"bg-yellow-100 text-yellow-800":1==e.domain_status?"bg-blue-100 text-blue-800":"bg-orange-100 text-red-800"),children:h(e)?"Timeout":1==e.domain_status?"Valid":"Invalid"})}),t.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 max-w-xs truncate",children:e.validation_response||"N/A"})]},e.id))})]})}),t.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex items-center justify-between",children:[t.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[t.jsx("button",{onClick:()=>m(e=>({...e,page:e.page-1})),disabled:1===x.page,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50",children:"Previous"}),t.jsx("button",{onClick:()=>m(e=>({...e,page:e.page+1})),disabled:x.page>=Math.ceil(f.length/x.rowsPerPage),className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50",children:"Next"})]}),t.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[t.jsx("div",{children:t.jsxs("p",{className:"text-sm text-gray-700",children:["Showing"," ",t.jsx("span",{className:"font-medium",children:(x.page-1)*x.rowsPerPage+1})," ","to"," ",t.jsx("span",{className:"font-medium",children:Math.min(x.page*x.rowsPerPage,f.length)})," ","of ",t.jsx("span",{className:"font-medium",children:f.length})," ","results"]})}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx("label",{htmlFor:"rows-per-page",className:"mr-2 text-sm text-gray-700",children:"Rows per page:"}),t.jsx("select",{id:"rows-per-page",value:x.rowsPerPage,onChange:e=>{m(t=>({...t,page:1,rowsPerPage:Number(e.target.value),total:f.length}))},className:"border border-gray-300 rounded-md shadow-sm py-1 pl-2 pr-8 text-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[10,25,50,100,200].map(e=>t.jsx("option",{value:e,children:e},e))})]}),t.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[t.jsxs("button",{onClick:()=>m(e=>({...e,page:1})),disabled:1===x.page,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50",children:[t.jsx("span",{className:"sr-only",children:"First"}),t.jsx("i",{className:"fas fa-angle-double-left"})]}),t.jsxs("button",{onClick:()=>m(e=>({...e,page:e.page-1})),disabled:1===x.page,className:"relative inline-flex items-center px-2 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50",children:[t.jsx("span",{className:"sr-only",children:"Previous"}),t.jsx("i",{className:"fas fa-angle-left"})]}),t.jsxs("span",{className:"relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-700",children:["Page ",x.page," of"," ",Math.ceil(f.length/x.rowsPerPage)]}),t.jsxs("button",{onClick:()=>m(e=>({...e,page:e.page+1})),disabled:x.page>=Math.ceil(f.length/x.rowsPerPage),className:"relative inline-flex items-center px-2 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50",children:[t.jsx("span",{className:"sr-only",children:"Next"}),t.jsx("i",{className:"fas fa-angle-right"})]}),t.jsxs("button",{onClick:()=>m(e=>({...e,page:Math.ceil(f.length/x.rowsPerPage)})),disabled:x.page>=Math.ceil(f.length/x.rowsPerPage),className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50",children:[t.jsx("span",{className:"sr-only",children:"Last"}),t.jsx("i",{className:"fas fa-angle-double-right"})]})]})]})]})]})]})})},r=()=>{const[r,l]=e.useState({listName:"",fileName:"",csvFile:null}),[i,n]=e.useState(null),[o,d]=e.useState(!1),[c,x]=e.useState(!1),[m,p]=e.useState([]),[g,u]=e.useState({page:1,rowsPerPage:10,total:0,search:""}),[h,f]=e.useState(null),b=e.useRef(null),y=e.useRef(),[j,v]=e.useState({}),[w,N]=e.useState(""),k=e.useCallback(async()=>{try{const e=new URLSearchParams({page:g.page,limit:g.rowsPerPage,search:g.search}),t=await fetch(`${s.GET_CSV_LIST}?${e}`),a=await t.json();p(Array.isArray(a.data)?a.data:[]),u(e=>({...e,total:a.total||0}))}catch(e){p([]),u(e=>({...e,total:0})),n({type:"error",message:"Failed to load lists"})}},[g.page,g.rowsPerPage,g.search]);e.useEffect(()=>{k()},[k]);const C=e=>{const{name:t,value:s}=e.target;l(e=>({...e,[t]:s}))},P=async(e,t)=>{try{const a=`${s.GET_RESULTS}?export=${e}&csv_list_id=${t}`,r=await fetch(a),l=await r.blob(),i=window.URL.createObjectURL(l),o=document.createElement("a");o.href=i,o.download=`${e}_emails_list_${t}.csv`,document.body.appendChild(o),o.click(),o.remove(),n({type:"success",message:`Exported ${e} emails list`})}catch{n({type:"error",message:`Failed to export ${e} emails`})}},L=({status:e,onClose:s})=>e&&t.jsxs("div",{className:`\n          fixed top-6 left-1/2 transform -translate-x-1/2 z-50\n          px-6 py-3 rounded-xl shadow text-base font-semibold\n          flex items-center gap-3\n          transition-all duration-300\n          backdrop-blur-md\n          ${"error"===e.type?"bg-red-200/60 border border-red-400 text-red-800":"bg-green-200/60 border border-green-400 text-green-800"}\n        `,style:{minWidth:250,maxWidth:400,boxShadow:"0 8px 32px 0 rgba(0, 0, 0, 0.23)",background:"error"===e.type?"rgba(255, 0, 0, 0.29)":"rgba(0, 200, 83, 0.29)",borderRadius:"16px",backdropFilter:"blur(8px)",WebkitBackdropFilter:"blur(8px)"},role:"alert",children:[t.jsx("i",{className:"fas text-lg "+("error"===e.type?"fa-exclamation-circle text-red-500":"fa-check-circle text-green-500")}),t.jsx("span",{className:"flex-1",children:e.message}),t.jsx("button",{onClick:s,className:"ml-2 text-gray-500 hover:text-gray-700 focus:outline-none","aria-label":"Close",children:t.jsx("i",{className:"fas fa-times"})})]});e.useEffect(()=>{if(i){const e=setTimeout(()=>n(null),4e3);return()=>clearTimeout(e)}},[i]),e.useEffect(()=>{let e;return c&&(e=setInterval(()=>{k()},2e3)),()=>clearInterval(e)},[c,k]),e.useEffect(()=>{N(g.search)},[g.search]);const _=e=>{switch(e){case"completed":return"bg-emerald-100 text-emerald-800";case"running":return"bg-blue-100 text-blue-800";case"pending":return"bg-amber-100 text-amber-800";case"failed":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return m.filter(e=>2===e.domain_status).length,t.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-7xl",children:[t.jsx(L,{status:i,onClose:()=>n(null)}),t.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-8 mt-12",children:[t.jsxs("div",{className:"flex items-center mb-6",children:[t.jsx("div",{className:"bg-blue-100 p-2 rounded-lg mr-4",children:t.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"})})}),t.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Upload Email List"})]}),t.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),n(null),!r.csvFile||!r.listName||!r.fileName)return void n({type:"error",message:"All fields are required"});if((await r.csvFile.text()).split(/\r?\n/).filter(e=>""!==e.trim()).length<2)return void n({type:"error",message:"CSV file must contain at least one data row."});const t=new FormData;t.append("csv_file",r.csvFile),t.append("list_name",r.listName),t.append("file_name",r.fileName);try{d(!0);const e=await fetch(s.API_UPLOAD,{method:"POST",body:t}),a=await e.json();"success"===a.status?(n({type:"success",message:a.message||"Upload successful"}),x(!0),b.current&&clearInterval(b.current),b.current=setInterval(async()=>{try{const e=await fetch("/api/verify/progress"),t=await e.json();k(),t.total>0&&t.processed>=t.total&&(clearInterval(b.current),setTimeout(()=>{x(!1),n({type:"success",message:"Verification completed!"}),k()},1e3))}catch(e){clearInterval(b.current),x(!1)}},2e3),l({listName:"",fileName:"",csvFile:null}),k(),(async()=>{try{const e=await fetch(`${s.GET_RESULTS}?retry_failed=1`);await e.json()}catch(e){}})()):n({type:"error",message:a.message||"Upload failed"})}catch(a){n({type:"error",message:"Network error"})}finally{d(!1)}},className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["List Name",t.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),t.jsx("input",{type:"text",name:"listName",value:r.listName,onChange:C,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"e.g. List_2025",required:!0})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["File Name",t.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),t.jsx("input",{type:"text",name:"fileName",value:r.fileName,onChange:C,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"e.g. File_2025.csv",required:!0})]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["CSV File",t.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),t.jsx("div",{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-lg hover:border-blue-400 transition-colors",children:t.jsx("div",{className:"space-y-1 text-center",children:r.csvFile?t.jsxs("div",{className:"flex items-center justify-center",children:[t.jsx("div",{className:"bg-green-100 p-2 rounded-lg mr-4",children:t.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsxs("div",{className:"text-left",children:[t.jsx("p",{className:"text-sm font-medium text-gray-700",children:r.csvFile.name}),t.jsxs("p",{className:"text-xs text-gray-500",children:[(r.csvFile.size/1024).toFixed(1)," KB"]})]})]}):t.jsxs(t.Fragment,{children:[t.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),t.jsxs("div",{className:"flex text-sm text-gray-600 justify-center",children:[t.jsxs("label",{className:"relative cursor-pointer bg-white rounded-md font-medium text-blue-600 hover:text-blue-500 focus-within:outline-none",children:[t.jsx("span",{children:"Upload a file"}),t.jsx("input",{type:"file",name:"csvFile",className:"sr-only",accept:".csv",onChange:e=>{const t=e.target.files[0];t&&t.size>5242880?n({type:"error",message:"CSV file size must be 5 MB or less."}):l(e=>({...e,csvFile:t}))},required:!0})]}),t.jsx("p",{className:"pl-1",children:"or drag and drop"})]}),t.jsx("p",{className:"text-xs text-gray-500",children:"Only 5MB CSV files"})]})})})]}),t.jsx("div",{className:"flex justify-center",children:t.jsx("button",{type:"submit",disabled:o,className:"px-6 py-3 bg-blue-600 text-white font-medium rounded-lg shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors flex items-center disabled:opacity-70",children:o?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):t.jsxs(t.Fragment,{children:[t.jsx("svg",{className:"w-5 h-5 mr-2 -ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"})}),"Upload & Verify"]})})})]})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"bg-blue-100 p-2 rounded-lg mr-4",children:t.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})}),t.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Email Lists"})]}),t.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 w-full sm:w-auto",children:[t.jsxs("div",{className:"relative flex-grow max-w-md",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx("svg",{className:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),t.jsx("input",{type:"text",placeholder:"Search lists...",className:"pl-10 w-full border border-gray-300 rounded-lg py-2 px-4 focus:ring-blue-500 focus:border-blue-500 transition-colors",value:w,onChange:e=>{const t=e.target.value;N(t),clearTimeout(y.current),y.current=setTimeout(()=>{u(e=>({...e,search:t,page:1}))},400)}})]}),t.jsx("div",{className:"flex gap-2"})]})]}),t.jsx("div",{className:"overflow-x-auto rounded-lg border border-gray-200",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ID"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"List Name"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Emails"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Valid/Invalid"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:0===m.length?t.jsx("tr",{children:t.jsx("td",{colSpan:6,className:"px-6 py-4 text-center text-gray-500 text-sm",children:g.search?"No lists match your search criteria":"No lists found. Upload a CSV file to get started."})}):m.filter(e=>e.list_name.toLowerCase().includes(g.search.toLowerCase())).map(e=>t.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.id}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.list_name}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:`px-2.5 py-0.5 inline-flex text-xs leading-5 font-semibold rounded-full ${_(e.status)}`,children:e.status.charAt(0).toUpperCase()+e.status.slice(1)})}),t.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[e.total_emails," total"]}),t.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:[t.jsxs("span",{className:"text-emerald-600 font-medium",children:[e.valid_count||0," valid"]})," ","/"," ",t.jsxs("span",{className:"text-red-600 font-medium",children:[e.invalid_count||0," invalid"]})]}),t.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium flex gap-2",children:[t.jsxs("button",{onClick:()=>f(e.id),className:"text-blue-600 hover:text-blue-800 transition-colors flex items-center",children:[t.jsxs("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"View"]}),t.jsxs("button",{onClick:()=>P("valid",e.id),className:"text-green-600 hover:text-green-800 transition-colors flex items-center",children:[t.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Valid"]}),t.jsxs("button",{onClick:()=>P("invalid",e.id),className:"text-red-600 hover:text-red-800 transition-colors flex items-center",children:[t.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Invalid"]}),t.jsxs("button",{onClick:()=>(async e=>{v(t=>({...t,[e]:!0})),n(null);try{const t=await fetch(`${s.GET_RESULTS}?retry_failed=1&csv_list_id=${e}`),a=await t.json();if(!a.total||0===a.total)return n({type:"error",message:"No failed emails to retry for this list"}),void v(t=>({...t,[e]:!1}));const r=await fetch(`${s.RETRY_SMTP}?csv_list_id=${e}`,{method:"POST"}),l=await r.json();if("success"!==l.status)throw new Error(l.message||"Failed to start retry");n({type:"success",message:`Retry started for ${a.total} emails in list ${e}`}),k()}catch(t){n({type:"error",message:t.message})}finally{v(t=>({...t,[e]:!1}))}})(e.id),disabled:j[e.id]||!e.failed_count,className:"text-yellow-600 hover:text-yellow-800 transition-colors flex items-center border border-yellow-300 rounded px-2 py-1 disabled:opacity-60",title:"Retry failed emails for this list",children:[t.jsx("svg",{className:"w-4 h-4 mr-1 "+(j[e.id]?"animate-spin":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 4v5h5M20 20v-5h-5M5.5 8.5a8 8 0 0113 0M18.5 15.5a8 8 0 01-13 0"})}),j[e.id]?"Retrying...":`Retry (${e.failed_count||0})`]})]})]},e.id))})]})}),m.length>0&&t.jsxs("div",{className:"flex flex-col items-center justify-center mt-6 px-1 gap-2",children:[t.jsxs("div",{className:"text-sm text-gray-500 mb-2",children:["Showing"," ",t.jsx("span",{className:"font-medium",children:(g.page-1)*g.rowsPerPage+1})," ","to"," ",t.jsx("span",{className:"font-medium",children:Math.min(g.page*g.rowsPerPage,g.total)})," ","of ",t.jsx("span",{className:"font-medium",children:g.total})," ","lists"]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:()=>u(e=>({...e,page:1})),disabled:1===g.page,className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 transition-colors font-bold text-gray-900",children:t.jsx("svg",{className:"w-5 h-5 text-gray-900",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 19l-7-7 7-7m8 14l-7-7 7-7"})})}),t.jsx("button",{onClick:()=>u(e=>({...e,page:e.page-1})),disabled:1===g.page,className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 transition-colors font-bold text-gray-900",children:t.jsx("svg",{className:"w-5 h-5 text-gray-900",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})})}),t.jsxs("span",{className:"text-sm font-bold text-gray-900",children:["Page ",g.page," of"," ",Math.max(1,Math.ceil(g.total/g.rowsPerPage))]}),t.jsx("button",{onClick:()=>u(e=>({...e,page:Math.min(Math.ceil(g.total/g.rowsPerPage),e.page+1)})),disabled:g.page>=Math.ceil(g.total/g.rowsPerPage),className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 transition-colors font-bold text-gray-900",children:t.jsx("svg",{className:"w-5 h-5 text-gray-900",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})})}),t.jsx("button",{onClick:()=>u(e=>({...e,page:Math.ceil(g.total/g.rowsPerPage)})),disabled:g.page>=Math.ceil(g.total/g.rowsPerPage),className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 transition-colors font-bold text-gray-900",children:t.jsx("svg",{className:"w-5 h-5 text-gray-900",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 5l7 7-7 7M5 5l7 7-7 7"})})}),t.jsx("select",{value:g.rowsPerPage,onChange:e=>u(t=>({...t,rowsPerPage:Number(e.target.value),page:1})),className:"border p-2 rounded-lg text-sm bg-white focus:ring-blue-500 focus:border-blue-500 transition-colors",children:[10,25,50,100].map(e=>t.jsx("option",{value:e,children:e},e))})]})]})]}),h&&t.jsx(a,{listId:h,onClose:()=>f(null)})]})};export{r as default};
