import{a as e,j as s}from"./react-core-Bz_OFM-J.js";import{A as t}from"./index-2wpkHUii.js";import"./editor-t5Pr0pkD.js";import"./react-dom-oZ-VTmTY.js";import"./vendor-ZyZh7GQr.js";import"./react-router-Cm8bNIlG.js";const a={pending:"bg-yellow-500",running:"bg-blue-600",paused:"bg-gray-500",completed:"bg-green-600",failed:"bg-red-600"},r=()=>{const[r,i]=e.useState([]),[l,n]=e.useState(!0),[d,o]=e.useState(null),c=e.useRef(!0),[x,m]=e.useState({page:1,rowsPerPage:10,total:0}),p=async()=>{c.current&&n(!0);try{const e=await fetch(t.API_MONITOR_CAMPAIGNS),s=await e.json();i(Array.isArray(s)?s:[]),m(e=>({...e,total:Array.isArray(s)?s.length:0}))}catch{o({type:"error",text:"Failed to load campaigns."})}n(!1),c.current=!1};e.useEffect(()=>{p();const e=setInterval(p,5e3);return()=>clearInterval(e)},[]);const g=Math.ceil(x.total/x.rowsPerPage),h=r.slice((x.page-1)*x.rowsPerPage,x.page*x.rowsPerPage);return e.useEffect(()=>{x.page>g&&g>0&&m(e=>({...e,page:1}))},[r,g,x.page]),s.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-7xl",children:[s.jsxs("h1",{className:"text-2xl font-bold text-gray-800 mb-6 flex items-center",children:[s.jsx("i",{className:"fas fa-chart-line mr-2 text-blue-600"}),"Campaign Monitor"]}),d&&s.jsxs("div",{className:"bg-red-100 border-l-4 border-red-500 text-red-700 p-4 mb-6 rounded-md flex items-start",children:[s.jsx("div",{className:"ml-3",children:s.jsx("p",{className:"text-sm font-medium",children:d.text})}),s.jsx("div",{className:"ml-auto pl-3",children:s.jsx("button",{onClick:()=>o(null),className:"text-gray-500 hover:text-gray-700",children:s.jsx("i",{className:"fas fa-times"})})})]}),s.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ID"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Progress"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Emails"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:l?s.jsx("tr",{children:s.jsx("td",{colSpan:5,className:"px-6 py-4 text-center text-sm text-gray-500",children:"Loading..."})}):0===h.length?s.jsx("tr",{children:s.jsx("td",{colSpan:5,className:"px-6 py-4 text-center text-sm text-gray-500",children:"No campaigns found."})}):h.map(e=>{const t=Math.max(e.total_emails||0,1),r=Math.min(e.sent_emails||0,t),i=Math.round(r/t*100),l=(e.campaign_status||"pending").toLowerCase();return s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.campaign_id}),s.jsx("td",{className:"px-6 py-4",children:s.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.description})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:`status-badge px-2 py-1 rounded text-xs font-semibold ${a[l]||"bg-gray-400"} text-white`,children:e.campaign_status||"Not started"})}),s.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[s.jsx("div",{className:"progress-bar h-5 bg-gray-200 rounded",children:s.jsx("div",{className:"progress-fill bg-blue-600 h-5 rounded",style:{width:`${i}%`}})}),s.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[i,"% (",e.sent_emails||0,"/",e.total_emails||0,")"]})]}),s.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[s.jsxs("div",{children:["Total: ",e.total_emails||0]}),s.jsxs("div",{children:["Pending: ",e.pending_emails||0]}),s.jsxs("div",{children:["Sent: ",e.sent_emails||0]}),s.jsxs("div",{children:["Failed: ",e.failed_emails||0]})]})]},e.campaign_id)})})]})})}),x.total>0&&s.jsxs("div",{className:"flex flex-col items-center justify-center mt-6 px-1 gap-2",children:[s.jsx("div",{className:"flex items-center gap-4 mb-2",children:s.jsxs("div",{className:"text-xs sm:text-sm text-gray-500",children:["Showing"," ",s.jsx("span",{className:"font-medium",children:(x.page-1)*x.rowsPerPage+1})," ","to"," ",s.jsx("span",{className:"font-medium",children:Math.min(x.page*x.rowsPerPage,x.total)})," ","of ",s.jsx("span",{className:"font-medium",children:x.total})," ","campaigns"]})}),s.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[s.jsx("button",{onClick:()=>m(e=>({...e,page:1})),disabled:1===x.page,className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 transition-colors",children:s.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 19l-7-7 7-7m8 14l-7-7 7-7"})})}),s.jsx("button",{onClick:()=>m(e=>({...e,page:e.page-1})),disabled:1===x.page,className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 transition-colors",children:s.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})})}),s.jsxs("span",{className:"text-xs sm:text-sm font-medium text-gray-700",children:["Page ",x.page," of ",g]}),s.jsx("button",{onClick:()=>m(e=>({...e,page:Math.min(g,e.page+1)})),disabled:x.page>=g,className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 transition-colors",children:s.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})})}),s.jsx("button",{onClick:()=>m(e=>({...e,page:g})),disabled:x.page>=g,className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 transition-colors",children:s.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 5l7 7-7 7M5 5l7 7-7 7"})})}),s.jsx("div",{className:"flex items-center gap-1 ml-4",children:s.jsx("select",{id:"rowsPerPage",value:x.rowsPerPage,onChange:e=>{m(s=>({...s,rowsPerPage:Number(e.target.value),page:1}))},className:"border border-gray-300 rounded px-2 py-2 text-xs sm:text-sm",children:[10,25,50,100].map(e=>s.jsx("option",{value:e,children:e},e))})})]})]})]})};export{r as default};
